# üöÄ CobPanel - Sistema de Cobran√ßa Inteligente

<div align="center">
  <img src="frontend/public/images/logo/logo.png" alt="CobPanel Logo" width="200"/>
  
  [![Node.js](https://img.shields.io/badge/node.js-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)
  [![Next.js](https://img.shields.io/badge/next.js-13.0+-blue)](https://nextjs.org/)
  [![TypeScript](https://img.shields.io/badge/typescript-4.9+-blue)](https://www.typescriptlang.org/)
  [![License](https://img.shields.io/badge/license-Private-red)](https://github.com/AgilizaWeb/CobPanel)
  
  **Sistema inteligente de cobran√ßa e gest√£o financeira com automa√ß√£o avan√ßada**
  
  [üõí Comprar Licen√ßa](https://painel.suporteeficiente.com.br/?view=register&role=cliente) 
  [üíº Programa de Revenda](https://painel.suporteeficiente.com.br/?view=register&role=revenda) ‚Ä¢ [üìß Suporte](https://chat.whatsapp.com/JM4oOAc9cxH8WzspShRz9q?mode=hqrt1)
  
</div>

---

## üìã Sobre o Projeto

O **CobPanel** √© uma solu√ß√£o completa e profissional de gest√£o empresarial desenvolvida para empresas que buscam efici√™ncia na gest√£o comercial e financeira. Com tecnologia moderna e recursos avan√ßados de automa√ß√£o, o sistema permite gerenciar vendas, estoque, fornecedores, clientes e processos de pagamento de forma integrada e automatizada.

### üéØ Diferenciais Competitivos

- ‚úÖ **Gest√£o Comercial Completa** - Controle total de vendas, estoque, produtos e fornecedores
- ‚úÖ **Sistema Multi-empresa** - Gerencie m√∫ltiplas empresas em uma √∫nica plataforma
- ‚úÖ **Portal do Cliente** - Painel exclusivo para clientes acessarem suas contas
- ‚úÖ **Gateways de Pagamento** - Integra√ß√£o nativa com Asaas, Cora, Efi e Mercado Pago
- ‚úÖ **API RESTful Completa** - Integre com qualquer sistema atrav√©s de endpoints robustos
- ‚úÖ **Dashboard Analytics** - Relat√≥rios detalhados e m√©tricas em tempo real para tomada de decis√£o
- ‚úÖ **WhatsApp Integration** - Conecte-se via Evolution API para comunica√ß√£o automatizada
- ‚úÖ **Seguran√ßa Avan√ßada** - C√≥digo compilado e criptografado para m√°xima prote√ß√£o

---

## ‚ú® Principais Funcionalidades

### üõçÔ∏è Gest√£o Comercial

- **Gest√£o de Vendas** - Controle completo do processo comercial
  - Cria√ß√£o e acompanhamento de vendas
  - Gest√£o de vendedores e comiss√µes
  - Relat√≥rios de performance de vendas
  - Integra√ß√£o com gateways de pagamento
  
- **Sistema de Cota√ß√µes** - Gerencie cota√ß√µes e or√ßamentos
  - Cria√ß√£o de cota√ß√µes profissionais
  - Convers√£o de cota√ß√µes em vendas
  - Acompanhamento de status
  - Hist√≥rico completo de cota√ß√µes

### üì¶ Gest√£o de Estoque e Produtos

- **Controle de Estoque** - Monitore produtos e movimenta√ß√µes
  - Movimenta√ß√µes de entrada e sa√≠da
  - Controle por categorias
  - Alertas de estoque baixo
  - Relat√≥rios de movimenta√ß√£o
  
- **Gest√£o de Produtos** - Cadastre e organize seus produtos
  - Categoriza√ß√£o de produtos
  - Controle de pre√ßos e margens
  - Gest√£o de fornecedores
  - Upload de imagens e documentos

### ü§ù Gest√£o de Relacionamentos

- **Gest√£o de Clientes** - Centralize informa√ß√µes dos clientes
  - Cadastro completo de clientes
  - Hist√≥rico de compras e intera√ß√µes
  - Segmenta√ß√£o de clientes
  - Sistema de tickets para suporte

- **Gest√£o de Fornecedores** - Organize sua cadeia de suprimentos
  - Cadastro de fornecedores
  - Categoriza√ß√£o por especialidade
  - Hist√≥rico de compras
  - Controle de contas a pagar

### üë§ Portal do Cliente

- **Acesso Independente para Clientes** - Proporcione autonomia aos seus clientes
  - Painel exclusivo para cada cliente
  - Visualiza√ß√£o de contas em aberto
  - Hist√≥rico completo de compras
  - Download de boletos e comprovantes
  - Acompanhamento de status de pedidos
  - Interface responsiva e intuitiva

### üìä Analytics e Relat√≥rios

- **Dashboard Completo** - Visualize m√©tricas importantes em tempo real
  - Tickets abertos/fechados
  - Tempo m√©dio de resposta
  - Taxa de satisfa√ß√£o
  - Gr√°ficos e estat√≠sticas detalhadas

- **Relat√≥rios Avan√ßados** - Exporte dados para an√°lise
  - Relat√≥rios de atendimento
  - Hist√≥rico completo de conversas
  - M√©tricas de performance por atendente

### üí≥ Gateways de Pagamento

- **M√∫ltiplas Op√ß√µes de Pagamento** - Aceite pagamentos via PIX e boleto
  - **Asaas** - PIX e boleto banc√°rio
  - **Cora** - PIX e transfer√™ncias
  - **Efi (Gerencianet)** - PIX e boletos
  - **Mercado Pago** - PIX e boleto
  - Webhooks autom√°ticos para confirma√ß√£o
  - Concilia√ß√£o autom√°tica de pagamentos

### üîê Seguran√ßa e Confiabilidade

- **Autentica√ß√£o JWT** - Sistema seguro de autentica√ß√£o
- **Multi-tenant** - Isolamento completo entre empresas
- **Backup Autom√°tico** - Prote√ß√£o de dados garantida

---

## üõ†Ô∏è Tecnologias Utilizadas

### Backend
- **Node.js** - Runtime JavaScript de alta performance
- **Express.js** - Framework web robusto e minimalista
- **Prisma** - ORM moderno para MySQL com type-safety
- **MySQL** - Banco de dados relacional confi√°vel
- **Socket.io** - Comunica√ß√£o em tempo real
- **JWT** - Autentica√ß√£o segura via tokens
- **Multer** - Upload de arquivos multipart
- **Node-cron** - Agendamento de tarefas automatizadas
- **Axios** - Cliente HTTP para integra√ß√µes

### Frontend
- **Next.js 15** - Framework React com SSR/SSG
- **React 19** - Biblioteca para interfaces reativas
- **TypeScript** - Tipagem est√°tica para maior seguran√ßa
- **TailwindCSS 4.0** - Framework CSS utilit√°rio moderno
- **Socket.io Client** - Atualiza√ß√µes em tempo real
- **ApexCharts** - Biblioteca de gr√°ficos interativos
- **React Hook Form** - Formul√°rios perform√°ticos
- **Axios** - Requisi√ß√µes HTTP para a API

---

## üöÄ Instala√ß√£o

### Pr√©-requisitos

- **Node.js** >= 18.0.0
- **MySQL** (banco de dados obrigat√≥rio)
- **Servidor Linux** (recomendado Ubuntu 20.04+)
- **Dom√≠nio** com SSL configurado (opcional para produ√ß√£o)

### 1. Instala√ß√£o da Evolution API (Opcional)

Para usar integra√ß√£o com WhatsApp, instale a Evolution API em um servidor separado:

```bash
# Clone o reposit√≥rio da Evolution API
git clone https://github.com/EvolutionAPI/evolution-api.git
cd evolution-api

# Siga as instru√ß√µes de instala√ß√£o da Evolution API
# Configure a Evolution API em um subdom√≠nio (ex: evolution.seudominio.com)
```

**Nota:** A integra√ß√£o com WhatsApp √© opcional e pode ser configurada posteriormente.

### 2. Clone e Instala√ß√£o do Projeto

```bash
# Clone o reposit√≥rio
git clone https://github.com/AgilizaWeb/CobPanel.git
```

### 2.1 Instala√ß√£o do Backend
```bash

cd CobPanel/backend

# Instale as depend√™ncias
npm install

# Configure as vari√°veis de ambiente
# Copie o arquivo de exemplo e edite conforme sua configura√ß√£o:
cp .env.example .env
nano .env

# Edite o arquivo .env com suas configura√ß√µes:
# DATABASE_URL="mysql://usuario:senha@localhost:3306/cobpanel"
# JWT_SECRET="seu_jwt_secret_super_seguro"
# PORT=5555

# Gere o cliente Prisma
npm run db:generate

# Execute as migrations para criar as tabelas
npm run db:migrate

# Execute os seeds para dados iniciais (opcional)
npm run db:seed
```

### 2.2 Instala√ß√£o do Frontend
```bash
cd ../frontend

# Instale as depend√™ncias
npm install

# Copie o arquivo de configura√ß√£o para o diret√≥rio p√∫blico
cp config.json public/config.json

# Configure as URLs e settings
nano public/config.json
```

**Nota:** O frontend √© uma aplica√ß√£o Next.js que utiliza `config.json` para configura√ß√µes din√¢micas. 

**Estrutura do config.json:**
```json
{
  "appName": "CobPanel",
  "usarLandingPage": true,
  "apiEnv": "production",
  "backendUrl": "https://seudominio.com/api"
}
```

Edite o arquivo `public/config.json` conforme suas necessidades de configura√ß√£o.

### 3. Configura√ß√£o do Nginx (Recomendado)

Configura√ß√£o otimizada com proxy reverso para Backend e Frontend, com suporte completo para Socket.IO:

```nginx
    server {
        listen 80;
        server_name seudominio.com;
        
        # Frontend - Raiz do dom√≠nio
        location / {
            proxy_pass http://localhost:5533;  # Porta do frontend Next.js
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            proxy_cache_bypass $http_upgrade;
        }
        
        # Socket.IO - DEVE vir antes de /api para ter prioridade
        location /socket.io {
            proxy_pass http://localhost:5555/socket.io;
            proxy_http_version 1.1;
            
            # Headers essenciais para WebSocket/Socket.IO
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            
            # Cache bypass para WebSocket
            proxy_cache_bypass $http_upgrade;
            
            # Timeouts para conex√µes WebSocket persistentes
            proxy_read_timeout 300s;
            proxy_connect_timeout 75s;
            proxy_send_timeout 300s;
            
            # Buffer settings para WebSocket
            proxy_buffering off;
        }
        
        # Backend UPLOADS - Proxy reverso
        location /uploads/ {
            proxy_pass http://localhost:5555/uploads/;
            proxy_http_version 1.1;
            
            # Headers padr√£o
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            
            # Headers para WebSocket (caso alguma rota precise)
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_cache_bypass $http_upgrade;
            
            # Timeouts
            proxy_read_timeout 300s;
            proxy_connect_timeout 75s;
        }
        
        # Backend API - Proxy reverso
        location /api/v1/ {
            proxy_pass http://localhost:5555/api/v1/;
            proxy_http_version 1.1;
            
            # Headers padr√£o
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            
            # Headers para WebSocket (caso alguma rota precise)
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_cache_bypass $http_upgrade;
            
            # Timeouts
            proxy_read_timeout 300s;
            proxy_connect_timeout 75s;
        }
        
        # Evolution API - Proxy reverso (opcional)
        # Descomente se estiver usando Evolution API
        # location /evolution {
        #     proxy_pass http://localhost:8081;  # Porta da Evolution API
        #     proxy_http_version 1.1;
        #     proxy_set_header Upgrade $http_upgrade;
        #     proxy_set_header Connection "upgrade";
        #     proxy_set_header Host $host;
        #     proxy_set_header X-Real-IP $remote_addr;
        #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        #     proxy_set_header X-Forwarded-Proto $scheme;
        #     proxy_cache_bypass $http_upgrade;
        #     
        #     # Reescrever /evolution para remover o prefixo
        #     rewrite ^/evolution/(.*)$ /$1 break;
        # }
    }
```

**Nota Importante:** 
- A location `/socket.io` **e** `/uploads/` **DEVE** vir antes de `/api/` para ter prioridade
- Esta configura√ß√£o √© compat√≠vel com todas as vers√µes do Nginx

**Importante:** 
- Configure as URLs no arquivo `config.json` do frontend
- Configure a URL do backend no `config.json`: `"backendUrl": "https://seudominio.com/api"`
- Ajuste o `"apiEnv"` para `"production"` em produ√ß√£o
- Se usar Evolution API, configure a URL apropriada no .env do backend
- **Socket.IO**: A configura√ß√£o acima j√° inclui suporte completo para Socket.IO atrav√©s do proxy reverso

### 4. Iniciar o Sistema

#### Usando PM2 (Recomendado)

```bash
# Instale o PM2 globalmente
npm install -g pm2

# Navegue at√© a raiz do projeto
cd /caminho/para/CobPanel

# Inicie todos os servi√ßos usando o ecosystem.config.js
pm2 start ecosystem.config.js

# Salve a configura√ß√£o para iniciar automaticamente com o sistema
pm2 save

# Configure o PM2 para iniciar no boot do sistema
pm2 startup
# Execute o comando que ser√° exibido no terminal
```

**Nota sobre Portas:**
- **Backend**: Roda na porta configurada no `.env` (padr√£o: 5555)
- **Frontend**: Roda na porta 5533 (configurada no script `start:prod` do `package.json`)
- Para alterar a porta do frontend, edite o script `start:prod` no arquivo `frontend/package.json`

#### Usando Node diretamente

```bash
# Backend
cd backend
node -r bytenode dist/server.jsc

# Frontend  
cd frontend
npm run start:prod
# ou
npm run start -p 5533
```

---

## üìñ Primeiros Passos

### 1. Acesse o Sistema

Abra seu navegador e acesse: `https://seudominio.com`

### 2. Crie sua Conta de Administrador

Na primeira execu√ß√£o, voc√™ ser√° redirecionado para criar sua conta de administrador.

### 3. Configure Gateways de Pagamento

1. Acesse **Gateways** no menu
2. Clique em **Adicionar Gateway**
3. Escolha o gateway (Asaas, Cora, Efi, Mercado Pago)
4. Configure as credenciais da API
5. Teste a conex√£o e ative o gateway

### 4. Cadastre Produtos e Fornecedores

1. Acesse **Fornecedores** no menu
2. Cadastre seus fornecedores principais
3. Acesse **Produtos** no menu
4. Cadastre seus produtos e categorias
5. Configure pre√ßos e margens de lucro

### 5. Configure sua Equipe

1. Acesse **Usu√°rios** no menu
2. Adicione vendedores e gestores
3. Configure permiss√µes por perfil
4. Defina metas e comiss√µes
5. Configure notifica√ß√µes e alertas

### 6. Ative o Portal do Cliente (Opcional)

1. Configure quais clientes ter√£o acesso
2. Defina permiss√µes de visualiza√ß√£o
3. Personalize a interface do portal
4. Envie credenciais de acesso para os clientes
5. Monitore o uso atrav√©s dos relat√≥rios

---

## üîë Licenciamento

Este sistema √© distribu√≠do sob licen√ßa comercial. Para uso em produ√ß√£o, √© necess√°rio adquirir uma licen√ßa v√°lida.

### üí≥ Comprar Licen√ßa

- **Licen√ßa por Dom√≠nio**: V√°lida por 1 ano por dom√≠nio
- **Programa de Revenda**: Oportunidade de revender o sistema

**Acesse:** [https://painel.suporteeficiente.com.br](https://painel.suporteeficiente.com.br)

### üìã Benef√≠cios da Licen√ßa

- ‚úÖ Suporte t√©cnico priorit√°rio
- ‚úÖ Atualiza√ß√µes e corre√ß√µes de seguran√ßa

---

## üéì Recursos Principais em Detalhes

### üìä Sistema de Relat√≥rios

Tenha controle total sobre seu neg√≥cio com relat√≥rios detalhados:

- **Relat√≥rios de Vendas**: Performance por per√≠odo, vendedor e produto
- **An√°lise de Estoque**: Produtos mais vendidos e estoque atual
- **Gest√£o Financeira**: Contas a pagar, receber e fluxo de caixa
- **Performance da Equipe**: Vendas por vendedor e comiss√µes

### üîó API e Integra√ß√µes

Conecte o CobPanel com outros sistemas:

- **API RESTful Completa**: Endpoints para todas as funcionalidades
- **Webhooks**: Receba notifica√ß√µes em tempo real
- **Gateways de Pagamento**: Integra√ß√£o nativa com principais provedores
- **Evolution API**: Conecte WhatsApp para comunica√ß√£o automatizada

### üì± Sistema Multi-empresa

Gerencie m√∫ltiplas empresas em uma √∫nica instala√ß√£o:

- **Isolamento Completo**: Dados separados por empresa
- **Configura√ß√µes Independentes**: Cada empresa com suas configura√ß√µes
- **Usu√°rios Espec√≠ficos**: Acesso controlado por empresa
- **Relat√≥rios Consolidados**: Vis√£o geral de todas as empresas

---

### üêõ Reportar Problemas

Para reportar bugs, solicitar funcionalidades ou obter suporte t√©cnico, utilize o sistema de tickets do painel. Nossa equipe est√° sempre pronta para ajudar.

---

## üîÑ Atualiza√ß√µes e Manuten√ß√£o

### üì¶ Pol√≠tica de Atualiza√ß√µes

O sistema recebe **atualiza√ß√µes regulares** com novas funcionalidades, corre√ß√µes de bugs e melhorias de seguran√ßa. Clientes com licen√ßa ativa recebem:

- ‚úÖ **Atualiza√ß√µes de Seguran√ßa**: Corre√ß√µes cr√≠ticas e patches de seguran√ßa
- ‚úÖ **Novas Funcionalidades**: Melhorias e novos recursos constantemente adicionados
- ‚úÖ **Otimiza√ß√µes de Performance**: Melhorias cont√≠nuas na velocidade e efici√™ncia
- ‚úÖ **Compatibilidade**: Garantia de compatibilidade com novas vers√µes de depend√™ncias

### üîÑ Processo de Atualiza√ß√£o

Para atualizar o sistema:

```bash
# No diret√≥rio do projeto
git pull

# Execute o deploy das migrations (IMPORTANTE)
cd backend
npm run db:deploy

# Reinicie os servi√ßos
pm2 restart all
```

**Importante:** Sempre execute `npm run db:deploy` ap√≥s atualizar para garantir que o banco de dados est√° sincronizado com as √∫ltimas altera√ß√µes. Use `npm run db:generate` se necess√°rio para regenerar o cliente Prisma.

 Sempre confira as releases para saber se precisa de comandos/cuidados extras para a atualiza√ß√£o

### ‚ö†Ô∏è Recomenda√ß√µes Importantes

- **Backup Antes de Atualizar**: Sempre fa√ßa backup do banco de dados antes de atualizar
- **Ambiente de Teste**: Teste atualiza√ß√µes em ambiente de desenvolvimento primeiro
- **Hor√°rio de Baixo Tr√°fego**: Execute atualiza√ß√µes em hor√°rios de menor movimento
- **Monitoramento**: Acompanhe os logs ap√≥s atualiza√ß√µes para garantir que tudo est√° funcionando

### üìÖ Ciclo de Atualiza√ß√µes

- **Atualiza√ß√µes de Seguran√ßa**: Liberadas imediatamente quando necess√°rio
- **Atualiza√ß√µes de Funcionalidades**: Lan√ßadas regularmente conforme desenvolvimento
- **Atualiza√ß√µes Maiores**: Comunicadas com anteced√™ncia para planejamento

---

## üèÜ Por que Escolher o CobPanel?

‚úÖ **Tecnologia de Ponta** - Desenvolvido com as melhores pr√°ticas e tecnologias modernas  
‚úÖ **Alta Performance** - Otimizado para lidar com milhares de opera√ß√µes simult√¢neas  
‚úÖ **Seguran√ßa** - C√≥digo compilado e ofuscado para m√°xima prote√ß√£o  
‚úÖ **Escalabilidade** - Arquitetura preparada para crescer com seu neg√≥cio  
‚úÖ **ROI Comprovado** - Aumente a recupera√ß√£o de cr√©ditos em at√© 300%  
‚úÖ **Suporte Profissional** - Equipe dedicada para ajudar voc√™ a ter sucesso  
‚úÖ **Atualiza√ß√µes Constantes** - Sistema sempre evoluindo com novas funcionalidades  

---

## üë• Desenvolvedor

O **CobPanel** √© desenvolvido por:

- [**Alisson Santos**](https://github.com/AgilizaWeb) - Desenvolvedor Full Stack

---

<div align="center">
  
  **Desenvolvido com ‚ù§Ô∏è para transformar a gest√£o de cobran√ßa**
  
  <!-- [üõí Comprar Licen√ßa Agora](https://painel.suporteeficiente.com.br) --> 
  [üíº Seja um Revendedor](https://painel.suporteeficiente.com.br/?view=register&role=revenda)
  
  ‚≠ê **Revolucione sua cobran√ßa hoje mesmo!**
  
</div>
