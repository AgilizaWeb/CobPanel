(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5329],{6829:(e,t,a)=>{"use strict";a.d(t,{Ri:()=>o,cookies:()=>u});var r=a(72378),n=a(25753);let s=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(0,n.WE)(),o=!!s&&"production"===s.apiEnv;r.A.set(e,t,{...a,secure:o,sameSite:"lax"})},o=e=>r.A.get(e),i=e=>{r.A.remove(e)},l={get:()=>o("token"),set:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s("token",e,t)},remove:()=>i("token")},c={get:()=>o("user"),set:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s("user",e,t)},remove:()=>i("user")},u={user:c,token:l,auth:{clear:()=>{c.remove(),l.remove()}}}},9678:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{FH:()=>e});var n=a(6829),s=a(95125),o=a(25753);async function i(){await (0,o.yN)(!0);let e=(0,o.WE)();if(null==e?void 0:e.backendUrl)return"".concat(e.backendUrl,"/api/v1");let t=(null==e?void 0:e.backendUrl)||"http://localhost:5555";return"".concat(t,"/api/v1")}let e=s.A.create({baseURL:await i(),headers:{"Content-Type":"application/json"}});e.interceptors.request.use(e=>{let t=n.cookies.token.get();return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),e.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(window.location.pathname.includes("/auth/login")||(n.cookies.auth.clear(),window.location.href="/auth/login")),Promise.reject(e)}),r()}catch(e){r(e)}},1)},15571:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{y:()=>o});var n=a(9678),s=e([n]);n=(s.then?(await s)():s)[0];let o={login:async e=>(await n.FH.post("/auth/login",e)).data,loginByToken:async e=>(await n.FH.post("/auth/login/".concat(e))).data,register:async e=>(await n.FH.post("/auth/register",e)).data,getMe:async()=>(await n.FH.get("/auth/me")).data,changePassword:async e=>(await n.FH.post("/auth/change-password",e)).data,resetPassword:async e=>(await n.FH.post("/auth/reset-password",e)).data,validateToken:async e=>(await n.FH.post("/auth/validate-token",{token:e})).data};r()}catch(e){r(e)}})},20063:(e,t,a)=>{"use strict";var r=a(47260);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},25753:(e,t,a)=>{"use strict";a.d(t,{WE:()=>c,yN:()=>u,zr:()=>d});var r=a(12115);let n=null,s=null,o=0,i={appName:"CobPanel",usarLandingPage:!1,apiEnv:"production",backendUrl:"http://localhost:5555"};async function l(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return n&&!e&&t-o<3e5?n:s&&!e?s:s=fetch("/api/config",{cache:e?"no-cache":"default",headers:{"Content-Type":"application/json"}}).then(async e=>{if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));return e.json()}).then(e=>{let a={appName:e.appName||i.appName,usarLandingPage:!!e.usarLandingPage,apiEnv:e.apiEnv||i.apiEnv,backendUrl:e.backendUrl||i.backendUrl};return n=a,o=t,a}).catch(a=>n&&!e?n:(n=i,o=t,i)).finally(()=>{s=null})}function c(){return n}async function u(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l(e)}function d(){let{config:e}=function(){let[e,t]=(0,r.useState)(n),[a,s]=(0,r.useState)(!n),[o,i]=(0,r.useState)(null),c=(0,r.useCallback)(async()=>{try{s(!0),i(null);let e=await l(!0);t(e)}catch(e){i(e instanceof Error?e.message:"Erro desconhecido")}finally{s(!1)}},[]);return(0,r.useEffect)(()=>{(!n||!n.backendUrl||n.backendUrl.includes("localhost"))&&l().then(t).catch(e=>{i(e instanceof Error?e.message:"Erro ao carregar configura\xe7\xe3o")}).finally(()=>s(!1))},[]),{config:e,loading:a,error:o,refreshConfig:c,isConfigured:!!n}}();return(null==e?void 0:e.backendUrl)||i.backendUrl}},41134:(e,t,a)=>{Promise.resolve().then(a.bind(a,45246))},45246:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>d});var n=a(95155),s=a(12115),o=a(20063),i=a(15571),l=a(6829),c=a(22663),u=e([i]);function d(){let{token:e}=(0,o.useParams)(),t=(0,o.useRouter)(),[a,r]=(0,s.useState)(!0),[u,d]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{if(!e){d("Token n\xe3o fornecido"),r(!1);return}try{r(!0),d(null);let a=await i.y.loginByToken(e);if(a.message&&a.data){let{user:e,token:r}=a.data;c.Ay.success("Login realizado com sucesso!"),l.cookies.token.set(r),l.cookies.user.set(JSON.stringify(e)),await new Promise(e=>setTimeout(e,1e3));let n={SUPERADMIN:"/dashboard/admin",ADMIN:"/dashboard/empresa",GESTOR:"/dashboard/empresa",VENDEDOR:"/dashboard/empresa",CLIENTE:"/dashboard/cliente"}[e.role]||"/";setTimeout(()=>{t.push(n),setTimeout(()=>{window.location.reload()},1500)},1500)}else throw Error("Resposta inv\xe1lida do servidor")}catch(r){var a,n;console.error("Erro no login por token:",r);let e=(null==(n=r.response)||null==(a=n.data)?void 0:a.error)||r.message||"Erro ao fazer login com o token";d(e),c.Ay.error(e),setTimeout(()=>{t.push("/auth/login")},3e3)}finally{r(!1)}})()},[e,t]),a)?(0,n.jsx)("div",{className:"flex flex-col flex-1 lg:w-1/2 w-full",children:(0,n.jsx)("div",{className:"w-full max-w-md sm:pt-10 mx-auto mb-5",children:(0,n.jsx)("div",{className:"flex flex-col justify-center flex-1 w-full max-w-md mx-auto",children:(0,n.jsxs)("div",{className:"mb-5 sm:mb-8",children:[(0,n.jsx)("h1",{className:"mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md",children:"Fazendo login..."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Aguarde enquanto verificamos seu token de acesso."})]})})})}):u?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,n.jsx)("div",{className:"max-w-md w-full space-y-8",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"mx-auto h-12 w-12 text-red-500",children:(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,n.jsx)("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900 dark:text-white",children:"Erro no Login"}),(0,n.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:u}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{onClick:()=>t.push("/auth/login"),className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Ir para Login"})}),(0,n.jsx)("p",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:"Voc\xea ser\xe1 redirecionado automaticamente em alguns segundos..."})]})})}):null}i=(u.then?(await u)():u)[0],r()}catch(e){r(e)}})}},e=>{e.O(0,[3598,2663,8441,1255,7358],()=>e(e.s=41134)),_N_E=e.O()}]);