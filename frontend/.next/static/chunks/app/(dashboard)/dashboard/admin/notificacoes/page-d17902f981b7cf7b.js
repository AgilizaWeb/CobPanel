(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4593],{26031:(a,e,s)=>{"use strict";s.a(a,async(a,i)=>{try{s.r(e),s.d(e,{default:()=>j});var l=s(95155),t=s(12115),r=s(13568),o=s(66695),c=s(37354),n=s(30353),d=s(60852),m=s(30174),u=s(12241),x=s(86061),f=s(40376),h=s(50597),g=s(63417),p=s(53780),v=s(35695),N=a([x,f,h,g]);function j(){let a=(0,v.useRouter)(),{marcarComoLida:e,marcarTodasComoLidas:s,deleteNotificacao:i}=(0,g.E)(),[N,j]=(0,t.useState)([]),[w,b]=(0,t.useState)(!0),[C,A]=(0,t.useState)(""),[y,P]=(0,t.useState)(1),[E,k]=(0,t.useState)(0),[R,S]=(0,t.useState)({}),[L,_]=(0,t.useState)(20),[M,O]=(0,t.useState)(!1),[G,T]=(0,t.useState)(null),F=(0,t.useCallback)(async()=>{try{var a;b(!0);let e={page:y,perPage:L};void 0!==R.lida&&(e.lida=R.lida),R.tipo&&(e.tipo=R.tipo);let s=await x.$p.notificacao.list(e);j(s.data||[]),k((null===(a=s.pagination)||void 0===a?void 0:a.totalPages)||1)}catch(a){console.error("Erro ao carregar notifica\xe7\xf5es:",a),r.oR.error("Erro ao carregar notifica\xe7\xf5es")}finally{b(!1)}},[y,R,L]);(0,t.useEffect)(()=>{F()},[F]);let I=N.filter(a=>{var e,s;if(!C)return!0;let i=C.toLowerCase();return a.titulo.toLowerCase().includes(i)||a.mensagem.toLowerCase().includes(i)||(null===(e=a.empresa)||void 0===e?void 0:e.nome.toLowerCase().includes(i))||(null===(s=a.user)||void 0===s?void 0:s.nome.toLowerCase().includes(i))}),V=a=>{S(e=>({...e,...a})),P(1)},B=async a=>{try{await e(a),await F(),r.oR.success("Notifica\xe7\xe3o marcada como lida")}catch(a){r.oR.error("Erro ao marcar notifica\xe7\xe3o como lida")}},D=async()=>{try{await s(),await F(),r.oR.success("Todas as notifica\xe7\xf5es foram marcadas como lidas")}catch(a){r.oR.error("Erro ao marcar todas como lidas")}},U=async a=>{if(window.confirm("Tem certeza que deseja excluir esta notifica\xe7\xe3o?"))try{await i(a),await F(),r.oR.success("Notifica\xe7\xe3o exclu\xedda com sucesso")}catch(a){r.oR.error("Erro ao excluir notifica\xe7\xe3o")}},q=a=>{let e=N.find(e=>e.id===a);e&&(T(e),O(!0))},z=[{value:"MANUAL",label:"Manual"},{value:"VENCIMENTO_EMPRESA",label:"Vencimento de Empresa"},{value:"PLANO_PAGO",label:"Plano Pago"},{value:"COBRANCA_GERADA",label:"Cobran\xe7a Gerada"},{value:"FATURA_PAGA",label:"Fatura Paga"},{value:"PARCELA_PAGA",label:"Parcela Paga"}],Q=[{value:"true",label:"Lidas"},{value:"false",label:"N\xe3o lidas"}],X=N.filter(a=>!a.lida).length;return(0,l.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Notifica\xe7\xf5es"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie todas as notifica\xe7\xf5es do sistema"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.A,{variant:"primary",onClick:()=>a.push("/dashboard/admin/notificacoes/criar"),startIcon:(0,l.jsx)(p.c1,{className:"w-4 h-4"}),"aria-label":"Criar nova notifica\xe7\xe3o",children:"Criar Notifica\xe7\xe3o"}),X>0&&(0,l.jsx)(d.A,{variant:"outline",onClick:D,"aria-label":"Marcar todas como lidas",children:"Marcar todas como lidas"})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row items-center gap-4",children:[(0,l.jsx)("div",{className:"flex-1 w-full sm:max-w-xs",children:(0,l.jsx)(c.A,{type:"text",placeholder:"Buscar notifica\xe7\xf5es...",value:C,onChange:a=>{A(a.target.value),P(1)},className:"w-full","aria-label":"Buscar notifica\xe7\xf5es"})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsx)(n.A,{placeholder:"Status",options:Q,value:void 0!==R.lida?Q.find(a=>a.value===String(R.lida)):void 0,onChange:a=>V({lida:a?"true"===a.value:void 0}),isClearable:!0,className:"whitespace-nowrap min-w-40","aria-label":"Filtrar por status"}),(0,l.jsx)(n.A,{placeholder:"Tipo",options:z,value:R.tipo?z.find(a=>a.value===R.tipo):void 0,onChange:a=>V({tipo:a?a.value:void 0}),isClearable:!0,className:"whitespace-nowrap min-w-50","aria-label":"Filtrar por tipo"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-4 gap-2 flex-wrap",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.A,{className:"flex items-center mb-0 h-full",children:"Quantidade por p\xe1gina"}),(0,l.jsx)(c.A,{className:"max-w-24",type:"number",defaultValue:L,max:100,min:1,onChange:a=>{let e=Number(a.target.value)||20;_(e),P(1)},"aria-label":"Itens por p\xe1gina"})]}),(0,l.jsx)(m.A,{currentPage:y,totalPages:E,onPageChange:P})]}),w?(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(a=>(0,l.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-48"},a))}):0===I.length?(0,l.jsxs)(o.Z,{className:"p-12 text-center",children:[(0,l.jsx)(p.XF,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Nenhuma notifica\xe7\xe3o encontrada"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:C||void 0!==R.lida||R.tipo?"Tente ajustar os filtros de busca":"N\xe3o h\xe1 notifica\xe7\xf5es no sistema"}),(0,l.jsx)(d.A,{variant:"primary",onClick:()=>a.push("/dashboard/admin/notificacoes/criar"),startIcon:(0,l.jsx)(p.c1,{className:"w-4 h-4"}),children:"Criar Primeira Notifica\xe7\xe3o"})]}):(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:I.map(a=>(0,l.jsx)(f.A,{notificacao:a,onMarcarComoLida:B,onDelete:U,onView:q},a.id))}),!w&&I.length>0&&(0,l.jsx)("div",{className:"mt-6 flex justify-center",children:(0,l.jsx)(m.A,{currentPage:y,totalPages:E,onPageChange:P})}),(0,l.jsx)(h.A,{isOpen:M,onClose:()=>{O(!1),T(null),F()},notificacao:G,onMarcarComoLida:B,onDelete:U})]})}[x,f,h,g]=N.then?(await N)():N,i()}catch(a){i(a)}})},87017:(a,e,s)=>{Promise.resolve().then(s.bind(s,26031))}},a=>{var e=e=>a(a.s=e);a.O(0,[8122,3568,9688,6980,8572,4691,4349,5813,1086,8441,1684,7358],()=>e(87017)),_N_E=a.O()}]);