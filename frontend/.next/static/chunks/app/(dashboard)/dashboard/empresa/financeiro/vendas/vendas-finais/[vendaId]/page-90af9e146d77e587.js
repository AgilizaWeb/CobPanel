(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4443],{35695:(e,a,s)=>{"use strict";var t=s(18999);s.o(t,"useParams")&&s.d(a,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})},49416:(e,a,s)=>{Promise.resolve().then(s.bind(s,55273))},55273:(e,a,s)=>{"use strict";s.a(e,async(e,t)=>{try{s.r(a),s.d(a,{default:()=>y});var r=s(95155),l=s(12115),d=s(35695),n=s(13568),c=s(62946),i=s(50420),m=s(58277),o=s(73580),u=s(13741),x=s(37354),g=s(21913),h=s(12241),f=s(61884),j=s(53780),v=e([c,o]);function y(e){let{params:a}=e,{vendaId:s}=(0,l.use)(a),t=(0,d.useRouter)(),[v,y]=(0,l.useState)(null),[p,N]=(0,l.useState)([]),[b,w]=(0,l.useState)(!0),[k,P]=(0,l.useState)(""),[S,R]=(0,l.useState)(1),[A,C]=(0,l.useState)(0),[E,F]=(0,l.useState)(!1),[O,_]=(0,l.useState)(null),[z,I]=(0,l.useState)(9),V=(0,l.useCallback)(async()=>{try{let e=await c.K.getById(Number(s));y(e.data)}catch(e){n.oR.error("Erro ao carregar venda")}},[s]),q=(0,l.useCallback)(async()=>{try{w(!0);let e=await c.O.list({page:S,limit:z,search:k,vendaId:Number(s)});N(e.data),C(e.pagination.pages)}catch(e){n.oR.error("Erro ao carregar faturas")}finally{w(!1)}},[S,k,z,s]);(0,l.useEffect)(()=>{V()},[V]),(0,l.useEffect)(()=>{q()},[q]);let T=e=>{_(e),F(!0)},G=async e=>{if(window.confirm("Tem certeza que deseja excluir esta fatura?"))try{await c.O.delete(e),n.oR.success("Fatura exclu\xedda com sucesso"),q()}catch(e){n.oR.error("Erro ao excluir fatura")}},Y=async e=>{try{O?(await c.O.update(O.id,e),n.oR.success("Fatura atualizada com sucesso")):(await c.O.create(e),n.oR.success("Fatura criada com sucesso")),F(!1),_(null),q()}catch(e){n.oR.error("Erro ao salvar fatura")}},B=async e=>{if(window.confirm("Tem certeza que deseja enviar esta fatura para o cliente?"))try{await c.O.send(e),n.oR.success("Fatura enviada com sucesso para o cliente")}catch(e){n.oR.error("Erro ao enviar fatura")}};return(0,r.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)(u.A,{variant:"secondary",size:"xs",onClick:()=>{t.push("/dashboard/empresa/financeiro/vendas")},className:"mb-2 bg-transparent",children:[(0,r.jsx)(j.YJ,{className:"w-5 h-5"}),"Voltar"]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:["Faturas da Venda #",s]}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie as faturas e pagamentos desta venda"})]})]}),v&&(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Informa\xe7\xf5es da Venda"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Valor Total"}),(0,r.jsx)("dd",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:(0,f.vv)(v.valorTotal)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Status"}),(0,r.jsx)("dd",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("PAGO"===v.status?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"),children:"PAGO"===v.status?"Pago":"Pendente"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"In\xedcio"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:(0,f.Yq)(v.inicio)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Fim"}),(0,r.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:(0,f.Yq)(v.fim)})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:(0,r.jsx)(x.A,{placeholder:"Buscar faturas...",value:k,onChange:e=>{P(e.target.value),R(1)},className:"max-w-xs"})}),(0,r.jsx)(u.A,{variant:"primary",onClick:()=>{_(null),F(!0)},children:"Nova Fatura"})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("div",{className:"flex justify-between mb-4 gap-2 flex-wrap",children:[(0,r.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,r.jsx)(h.A,{className:"flex items-center mb-0 h-full",children:"Quantidade por p\xe1gina"}),(0,r.jsx)(x.A,{className:"max-w-24",defaultValue:z,max:100,min:1,onChange:e=>{let a=Number(e.target.value)||9;I(a),R(1)}})]}),(0,r.jsx)(g.A,{currentPage:S,totalPages:A,onPageChange:R})]})})]}),b?(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-64"},e))}):(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:p.length>0?p.map(e=>(0,r.jsx)(i.A,{vendaFinal:e,onEdit:()=>T(e),onDelete:()=>G(e.id),onSend:()=>B(e.id)},e.id)):(0,r.jsx)("div",{className:"col-span-full text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma fatura encontrada para esta venda."})})}),A>1&&(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)("div",{className:"flex justify-end mb-4 gap-2 flex-wrap",children:(0,r.jsx)(g.A,{currentPage:S,totalPages:A,onPageChange:R})})}),(0,r.jsx)(m.a,{isOpen:E,onClose:()=>{F(!1),_(null)},className:"max-w-[800px] m-4",children:(0,r.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,r.jsxs)("div",{className:"px-2 pr-14",children:[(0,r.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:O?"Editar Fatura":"Nova Fatura"}),(0,r.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:O?"Atualize as informa\xe7\xf5es da fatura.":"Preencha os dados para criar uma nova fatura."})]}),(0,r.jsx)(o.A,{vendaFinal:O,vendaId:Number(s),onSubmit:Y,onCancel:()=>{F(!1),_(null)}})]})})]})}[c,o]=v.then?(await v)():v,t()}catch(e){t(e)}})}},e=>{var a=a=>e(e.s=a);e.O(0,[6474,8122,3568,9688,6980,4691,1726,3021,8441,1684,7358],()=>a(49416)),_N_E=e.O()}]);