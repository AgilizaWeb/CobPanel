(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4216],{50221:(e,a,s)=>{"use strict";s.a(e,async(e,t)=>{try{s.r(a),s.d(a,{default:()=>f});var l=s(95155),r=s(12115),n=s(22663),i=s(50412),c=s(40989),o=s(43698),d=s(7735),u=s(55355),m=s(62339),x=s(21371),v=s(73424),g=s(30304),p=s(30781),h=e([d,u,x]);function f(){let[e,a]=(0,r.useState)([]),[s,t]=(0,r.useState)([]),[h,f]=(0,r.useState)(!0),[w,y]=(0,r.useState)(""),[j,b]=(0,r.useState)(1),[N,C]=(0,r.useState)(0),[E,S]=(0,r.useState)(!1),[k,A]=(0,r.useState)(null),[I,_]=(0,r.useState)({}),[P,O]=(0,r.useState)(9),R=(0,r.useCallback)(async()=>{try{let e=await u.k.list({limit:100});t(e.data||[])}catch(e){console.error("Erro ao carregar gateways:",e)}},[]),B=(0,r.useCallback)(async()=>{try{f(!0);let e=await d.O.list({page:j,limit:P,search:w,status:"PENDING",type:I.type,vencimento:I.vencimento,gatewayId:I.gatewayId,orderBy:I.orderBy});a(e.data),C(e.pagination.pages)}catch(e){n.oR.error("Erro ao carregar contas a receber")}finally{f(!1)}},[j,w,I,P]);(0,r.useEffect)(()=>{R()},[R]),(0,r.useEffect)(()=>{B()},[B]);let F=e=>{_(a=>({...a,...e})),b(1)},M=async e=>{if(window.confirm("Tem certeza que deseja excluir esta fatura?"))try{await d.O.delete(e),n.oR.success("Fatura exclu\xedda com sucesso"),B()}catch(e){n.oR.error("Erro ao excluir fatura")}},V=async e=>{if(window.confirm("Tem certeza que deseja enviar esta fatura para o cliente?"))try{await d.O.send(e),n.oR.success("Fatura enviada com sucesso para o cliente")}catch(e){n.oR.error("Erro ao enviar fatura")}},D=async e=>{try{k&&(await d.O.update(k.id,e),n.oR.success("Fatura atualizada com sucesso"),S(!1),A(null),B())}catch(e){n.oR.error("Erro ao salvar fatura")}},T=[{value:"PIX",label:"PIX"},{value:"BOLETO",label:"Boleto"}],z=[{value:"vencimento_asc",label:"Vencimento - Mais pr\xf3ximo"},{value:"vencimento_desc",label:"Vencimento - Mais distante"},{value:"valor_desc",label:"Valor - Maior"},{value:"valor_asc",label:"Valor - Menor"},{value:"createdAt_desc",label:"Criado - Mais recente"},{value:"createdAt_asc",label:"Criado - Mais antigo"}];return(0,l.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Contas a Receber"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie todas as faturas pendentes de recebimento"})]})}),(0,l.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row items-center gap-4",children:[(0,l.jsx)("div",{className:"flex-1 w-full sm:max-w-xs",children:(0,l.jsx)(c.A,{type:"text",placeholder:"Buscar faturas...",value:w,onChange:e=>{y(e.target.value),b(1)},className:"w-full"})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsx)(o.A,{placeholder:"Tipo",options:T,value:T.find(e=>e.value===I.type),onChange:e=>F({type:e?e.value:void 0}),isClearable:!0,className:"whitespace-nowrap min-w-40"}),(0,l.jsx)("div",{className:"min-w-48",children:(0,l.jsx)(p.A,{id:"vencimento",onChange:e=>{F({vencimento:e[0]||void 0})},defaultDate:I.vencimento})}),(0,l.jsx)(o.A,{placeholder:"Gateway",options:s.map(e=>({value:e.id.toString(),label:"".concat(e.nome," (").concat(e.gateway,") ").concat(e.isDefault?"(Padr\xe3o)":"")})),value:s.find(e=>e.id===I.gatewayId)?{value:I.gatewayId.toString(),label:s.find(e=>e.id===I.gatewayId).nome}:void 0,onChange:e=>F({gatewayId:e?parseInt(e.value):void 0}),isClearable:!0,className:"whitespace-nowrap min-w-50"}),(0,l.jsx)(o.A,{placeholder:"Ordenar por",options:z,value:z.find(e=>e.value===I.orderBy),onChange:e=>F({orderBy:e?e.value:void 0}),isClearable:!0,className:"whitespace-nowrap min-w-50"})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-between mb-4 gap-2 flex-wrap",children:[(0,l.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,l.jsx)(g.A,{className:"flex items-center mb-0 h-full",children:"Quantidade por p\xe1gina"}),(0,l.jsx)(c.A,{className:"max-w-24",defaultValue:P,max:100,min:1,onChange:e=>{let a=Number(e.target.value)||9;O(a),b(1)}})]}),(0,l.jsx)(v.A,{currentPage:j,totalPages:N,onPageChange:b})]}),h?(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,l.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-48"},e))}):(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.length>0?e.map(e=>(0,l.jsx)(m.A,{vendaFinal:e,onEdit:()=>{A(e),S(!0)},onDelete:()=>M(e.id),onSend:()=>V(e.id)},e.id)):(0,l.jsx)("div",{className:"col-span-full text-center py-12",children:(0,l.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma fatura pendente encontrada"})})}),N>1&&(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)("div",{className:"flex justify-end mb-4 gap-2 flex-wrap",children:(0,l.jsx)(v.A,{currentPage:j,totalPages:N,onPageChange:b})})}),(0,l.jsx)(i.a,{isOpen:E,onClose:()=>{S(!1),A(null)},className:"max-w-[800px] m-4",children:(0,l.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,l.jsx)("div",{className:"px-2 pr-14",children:(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Editar Fatura"})}),(0,l.jsx)(x.A,{vendaFinal:k,vendaId:(null==k?void 0:k.vendaId)||0,onSubmit:D,onCancel:()=>{S(!1),A(null)}})]})})]})}[d,u,x]=h.then?(await h)():h,t()}catch(e){t(e)}})},88595:(e,a,s)=>{Promise.resolve().then(s.bind(s,50221))}},e=>{e.O(0,[4674,3598,2663,5889,7750,4691,4257,8946,8441,1255,7358],()=>e(e.s=88595)),_N_E=e.O()}]);