(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9249],{5846:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});var r=a(95155);a(12115);var l=a(50420);function n(e){let{items:t,onSend:a}=e;return(null==t?void 0:t.length)?(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,r.jsx)(l.A,{vendaFinal:e,onSend:a?()=>a(e.id):void 0,onEdit:()=>{},onDelete:()=>{},showActions:!1},e.id))}):(0,r.jsx)("div",{className:"rounded-2xl border border-dashed border-gray-200 p-6 text-center text-gray-500 dark:border-gray-800 dark:text-gray-400",children:"Sem faturas recentes"})}},10255:(e,t,a)=>{"use strict";function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),a(95155),a(47650),a(85744),a(20589)},17828:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,a(64054).createAsyncLocalStorage)()},26580:(e,t,a)=>{Promise.resolve().then(a.bind(a,38031))},27888:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var r=a(95155),l=a(55028);a(12115);let n=(0,l.default)(()=>Promise.all([a.e(7776),a.e(8699)]).then(a.bind(a,78699)),{loadableGenerated:{webpack:()=>[78699]},ssr:!1}),s={PENDING:"Pendente",APPROVED:"Pago",CANCELLED:"Cancelado",PENDENTE:"Pendente",PAGO:"Pago"},o={PENDING:"#f59e0b",APPROVED:"#10b981",CANCELLED:"#ef4444",PENDENTE:"#f59e0b",PAGO:"#10b981"};function i(e){var t,a;let{items:l}=e,i=null!==(t=null==l?void 0:l.map(e=>{var t;return null!==(t=s[e.status])&&void 0!==t?t:e.status}))&&void 0!==t?t:[],d=null!==(a=null==l?void 0:l.map(e=>e.total))&&void 0!==a?a:[],c=null==l?void 0:l.map(e=>{var t;return null!==(t=o[e.status])&&void 0!==t?t:"#6366f1"});return(0,r.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[(0,r.jsx)("h3",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white/90",children:"Vendas por status"}),(0,r.jsx)(n,{options:{chart:{type:"donut",height:320,fontFamily:"Outfit, sans-serif"},labels:i,legend:{position:"bottom"},dataLabels:{enabled:!0},colors:c,tooltip:{y:{formatter:e=>"".concat(e)}}},series:d,type:"donut",height:320})]})}},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},36645:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=a(88229)._(a(67357));function l(e,t){var a;let l={};"function"==typeof e&&(l.loader=e);let n={...l,...t};return(0,r.default)({...n,modules:null==(a=n.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},38031:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>p});var l=a(95155),n=a(12115),s=a(66681),o=a(43244),i=a(80148),d=a(27888),c=a(62946),u=a(5846),m=a(30353),g=a(37354),v=a(19824),h=a(21913),f=a(40334),b=a(86061),x=e([s,c,f,b]);function p(){var e;let{user:t}=(0,s.A)(),[a,r]=(0,n.useState)(!0),[x,p]=(0,n.useState)([]),[y,j]=(0,n.useState)([]),[w,S]=(0,n.useState)({data:[],pagination:{total:0,page:1,limit:1,pages:0},message:""}),N=new Date(new Date().getFullYear(),0,1),k=new Date(new Date().getFullYear(),11,31),[P,O]=(0,n.useState)(""),[C,A]=(0,n.useState)(void 0),[D,I]=(0,n.useState)(void 0),[_,E]=(0,n.useState)("".concat(N.toISOString(),",").concat(k.toISOString())),[M,R]=(0,n.useState)(void 0),[F,L]=(0,n.useState)("createdAt_desc"),[T,V]=(0,n.useState)(1),[Y,G]=(0,n.useState)(10),[B,J]=(0,n.useState)(0),z=null==t?void 0:t.empresaId;(0,n.useEffect)(()=>{let e=!1;return(async()=>{if(z)try{var t;r(!0);let[a,l,n]=await Promise.all([f.k.list({page:0,limit:0}),c.O.list({page:T,limit:Y,search:P,type:C,status:D,vencimento:_,gatewayId:M,orderBy:F}),b.UR.list({page:1,limit:1,search:""})]);if(e)return;j(a.data||[]),p(l.data||[]),S(n),J((null===(t=l.pagination)||void 0===t?void 0:t.pages)||0)}catch(e){console.error("Erro ao carregar dashboard",e)}finally{e||r(!1)}})(),()=>{e=!0}},[z,T,Y,P,C,D,_,M,F]);let X=(0,n.useMemo)(()=>{let e=Array(12).fill(0);if(!(null==x?void 0:x.length))return e;let t=new Date().getFullYear();for(let r of x){var a;let l=new Date(r.vencimento);if("APPROVED"!==r.status||l.getFullYear()!==t)continue;let n=l.getMonth(),s=Number(null!==(a=r.valor)&&void 0!==a?a:0);Number.isNaN(s)||(e[n]+=s)}return console.log("receitaMensal:",e),e},[x]),U=(0,n.useMemo)(()=>{let e=new Map;for(let t of x){let a=t.status,r=e.get(a)||0;e.set(a,r+(Number(t.valor)||0))}return Array.from(e.entries()).map(e=>{let[t,a]=e;return{status:t,total:a}})},[x]),W=async e=>{try{await c.O.send(e)}catch(e){}};return(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-4 md:gap-6",children:[(0,l.jsxs)("div",{className:"col-span-12 space-y-6 xl:col-span-7",children:[(0,l.jsx)(o.c,{totalClientes:w.pagination.total,totalVendas:x.length,totalRecebido:x.filter(e=>"APPROVED"===e.status).reduce((e,t)=>e+(Number(t.valor)||0),0)}),(0,l.jsx)(i.k,{data:X})]}),(0,l.jsx)("div",{className:"col-span-12 xl:col-span-5",children:(0,l.jsx)(d.Y,{items:U})}),(0,l.jsxs)("div",{className:"col-span-12 space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,l.jsx)("div",{className:"flex-1 max-w-xs",children:(0,l.jsx)(g.A,{type:"text",placeholder:"Buscar faturas...",value:P,onChange:e=>{O(e.target.value),V(1)}})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 items-end",children:[(0,l.jsx)(m.A,{placeholder:"Tipo",options:[{value:"PIX",label:"PIX"},{value:"BOLETO",label:"Boleto"}],value:C?{value:C,label:C}:void 0,onChange:e=>{A(e?e.value:void 0),V(1)},isClearable:!0,className:"min-w-40"}),(0,l.jsx)(m.A,{placeholder:"Status",options:[{value:"PENDING",label:"Pendente"},{value:"APPROVED",label:"Aprovado"},{value:"CANCELLED",label:"Cancelado"}],value:D?{value:D,label:D}:void 0,onChange:e=>{I(e?e.value:void 0),V(1)},isClearable:!0,className:"min-w-40"}),(0,l.jsx)("div",{className:"min-w-48",children:(0,l.jsx)(v.A,{id:"vencimento",mode:"range",onClickClean:e=>{e&&(e.clear(),e.close(),E(void 0),V(1))},onClickHj:e=>{if(e){let t=new Date;e.setDate(t),e.close(),E(t.toISOString()),V(1)}},onClickAno:e=>{if(e){let t=new Date,a=new Date(t.getFullYear(),0,1),r=new Date(t.getFullYear(),11,31);e.setDate(a),e.setDate(r),e.close(),E("".concat(a.toISOString(),",").concat(r.toISOString())),V(1)}},onClickMes:e=>{if(e){let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1),r=new Date(t.getFullYear(),t.getMonth()+1,0);e.setDate(a),e.setDate(r),e.close(),E("".concat(a.toISOString(),",").concat(r.toISOString())),V(1)}},onChange:e=>{var t,a,r;let l=e.length,n=l>1?(null==e?void 0:null===(t=e[0])||void 0===t?void 0:t.toISOString())+","+(null==e?void 0:null===(a=e[1])||void 0===a?void 0:a.toISOString()):null==e?void 0:null===(r=e[0])||void 0===r?void 0:r.toISOString();l>1&&(E(n),V(1))},defaultDate:(null==_?void 0:_.split(",").map(e=>new Date(e)))||void 0})}),(0,l.jsx)(m.A,{placeholder:"Gateway",options:y.map(e=>({value:e.id.toString(),label:"".concat(e.nome," (").concat(e.gateway,")").concat(e.isDefault?" (Padr\xe3o)":"")})),value:M?{value:M.toString(),label:(null===(e=y.find(e=>e.id===M))||void 0===e?void 0:e.nome)||""}:void 0,onChange:e=>{R(e?parseInt(e.value):void 0),V(1)},isClearable:!0,className:"min-w-50"}),(0,l.jsx)(m.A,{placeholder:"Ordenar por",options:[{value:"createdAt_desc",label:"Criado - Mais recente"},{value:"createdAt_asc",label:"Criado - Mais antigo"},{value:"vencimento_asc",label:"Vencimento - Mais pr\xf3ximo"},{value:"vencimento_desc",label:"Vencimento - Mais distante"},{value:"valor_desc",label:"Valor - Maior"},{value:"valor_asc",label:"Valor - Menor"}],value:{value:F,label:""},onChange:e=>{L(e?e.value:"createdAt_desc"),V(1)},isClearable:!1,className:"min-w-50"})]})]}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Faturas"}),(0,l.jsx)(u.u,{items:x,onSend:W}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Itens por p\xe1gina:",(0,l.jsx)("select",{title:"Itens por p\xe1gina",className:"ml-2 rounded border border-gray-300 bg-white px-2 py-1 text-sm dark:bg-gray-900 dark:border-gray-700",value:Y,onChange:e=>{G(parseInt(e.target.value)),V(1)},children:[5,10,20].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsx)(h.A,{totalPages:B,currentPage:T,onPageChange:V})]})]})]})}[s,c,f,b]=x.then?(await x)():x,r()}catch(e){r(e)}})},43244:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var r=a(95155);a(12115);var l=a(53780),n=a(61884);function s(e){let{totalClientes:t,totalVendas:a,totalRecebido:s}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] md:p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded-xl dark:bg-gray-800",children:(0,r.jsx)(l.nF,{className:"text-gray-800 size-6 dark:text-white/90"})}),(0,r.jsx)("div",{className:"flex items-end justify-between mt-5",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Clientes"}),(0,r.jsx)("h4",{className:"mt-2 font-bold text-gray-800 text-title-sm dark:text-white/90",children:t})]})})]}),(0,r.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] md:p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded-xl dark:bg-gray-800",children:(0,r.jsx)(l.pC,{className:"text-gray-800 dark:text-white/90"})}),(0,r.jsx)("div",{className:"flex items-end justify-between mt-5",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Vendas"}),(0,r.jsx)("h4",{className:"mt-2 font-bold text-gray-800 text-title-sm dark:text-white/90",children:a})]})})]}),(0,r.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03] md:p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded-xl dark:bg-gray-800",children:(0,r.jsx)(l.cr,{className:"text-gray-800 dark:text-white/90"})}),(0,r.jsx)("div",{className:"flex items-end justify-between mt-5",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total recebido"}),(0,r.jsx)("h4",{className:"mt-2 font-bold text-gray-800 text-title-sm dark:text-white/90",children:(0,n.vv)(s||0)})]})})]})]})}},55028:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var r=a(36645),l=a.n(r)},62146:(e,t,a)=>{"use strict";function r(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),a(45262)},64054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return s},createAsyncLocalStorage:function(){return n},createSnapshot:function(){return o}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let l="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function n(){return l?new l:new r}function s(e){return l?l.bind(e):r.bind(e)}function o(){return l?l.snapshot():function(e,...t){return e(...t)}}},66681:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{A:()=>d});var l=a(12115),n=a(35695),s=a(86061),o=a(2034),i=e([s]);function d(){let e=(0,n.useRouter)(),[t,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(!0),d=(0,l.useRef)(!1);(0,l.useEffect)(()=>{if(d.current)return;let e=localStorage.getItem("user");if(e&&!t)try{a(JSON.parse(e))}catch(e){console.error("Erro ao parsear usu\xe1rio do cache:",e),localStorage.removeItem("user")}d.current=!0},[t]),(0,l.useEffect)(()=>{let t=localStorage.getItem("ultimoCheck"),r=localStorage.getItem("loadingCheck"),l=Date.now()-parseInt(t||"0");(localStorage.getItem("user")||t||r)&&(!t||!(l>6e4))||(localStorage.removeItem("loadingCheck"),localStorage.removeItem("ultimoCheck"));let n=async()=>{localStorage.setItem("loadingCheck","true");try{let e=await s.$p.auth.getMe();console.log("Authenticated user:",e.data),a(e.data),localStorage.setItem("user",JSON.stringify(e.data)),localStorage.removeItem("loadingCheck"),localStorage.setItem("ultimoCheck",Date.now().toString()),await new Promise(e=>setTimeout(e,1e4))}catch(t){o.cookies.token.remove(),e.push("/auth/login")}finally{i(!1)}};if(r||l<1e4){i(!1);return}n()},[e]);let c=!!t;return{user:t,loading:r,isAuthenticated:c,logout:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];o.cookies.auth.clear(),a(null),localStorage.removeItem("user"),localStorage.removeItem("ultimoCheck"),localStorage.removeItem("loadingCheck"),t&&e.push("/auth/login")},updateUser:e=>{t&&a({...t,...e})}}}s=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})},67357:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let r=a(95155),l=a(12115),n=a(62146);function s(e){return{default:e&&"default"in e?e.default:e}}a(10255);let o={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},i=function(e){let t={...o,...e},a=(0,l.lazy)(()=>t.loader().then(s)),i=t.loading;function d(e){let s=i?(0,r.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,d=o?l.Suspense:l.Fragment,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(d,{...o?{fallback:s}:{},children:c})}return d.displayName="LoadableComponent",d}},80148:(e,t,a)=>{"use strict";a.d(t,{k:()=>i});var r=a(95155),l=a(12115),n=a(61884);let s=(0,a(55028).default)(()=>Promise.all([a.e(7776),a.e(8699)]).then(a.bind(a,78699)),{loadableGenerated:{webpack:()=>[78699]},ssr:!1}),o=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];function i(e){let{data:t}=e,a=(0,l.useMemo)(()=>t&&0!==t.length?"number"==typeof t[0]?o.map((e,a)=>{var r;return{label:e,revenue:Number(null!==(r=t[a])&&void 0!==r?r:0)}}):t.map((e,t)=>{var a,r,l;return{label:null!==(r=null!==(a=e.label)&&void 0!==a?a:o[t])&&void 0!==r?r:"M".concat(t+1),revenue:Number(null!==(l=e.revenue)&&void 0!==l?l:0)}}):o.map(e=>({label:e,revenue:0})),[t]),i=a.map(e=>e.label),d=a.map(e=>e.revenue);return(0,r.jsxs)("div",{className:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-5 pt-5 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6 sm:pt-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white/90",children:"Receita por m\xeas"})}),(0,r.jsx)("div",{className:"max-w-full overflow-x-auto custom-scrollbar",children:(0,r.jsx)("div",{className:"-ml-5 min-w-[650px] xl:min-w-full pl-2",children:(0,r.jsx)(s,{options:{colors:["#465fff"],chart:{fontFamily:"Outfit, sans-serif",type:"bar",height:200,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"39%",borderRadius:5,borderRadiusApplication:"end"}},dataLabels:{enabled:!1},stroke:{show:!0,width:4,colors:["transparent"]},xaxis:{categories:i,axisBorder:{show:!1},axisTicks:{show:!1}},legend:{show:!1},yaxis:{labels:{formatter:e=>"".concat((0,n.vv)(e))}},grid:{yaxis:{lines:{show:!0}}},fill:{opacity:1},tooltip:{x:{show:!1},y:{formatter:e=>"".concat((0,n.vv)(e))}}},series:[{name:"Receita",data:d}],type:"bar",height:200})})})]})}},85744:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=a(17828)}},e=>{var t=t=>e(e.s=t);e.O(0,[6474,8122,9688,6980,4691,4349,1726,8441,1684,7358],()=>t(26580)),_N_E=e.O()}]);