(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[907],{22041:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>n});var o=a(95155),s=a(12115),u=a(66681),l=a(35695),c=e([u]);function n(e){let{children:t}=e,{user:a,loading:r}=(0,u.A)(),c=(0,l.useRouter)();return((0,s.useEffect)(()=>{r||a&&"CLIENTE"===a.role||c.push("/auth/login")},[a,r,c]),r)?(0,o.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):a&&"CLIENTE"===a.role?(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,o.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t})}):null}u=(c.then?(await c)():c)[0],r()}catch(e){r(e)}})},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},62320:(e,t,a)=>{Promise.resolve().then(a.bind(a,22041))},66681:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{A:()=>n});var o=a(12115),s=a(35695),u=a(86061),l=a(2034),c=e([u]);function n(){let e=(0,s.useRouter)(),[t,a]=(0,o.useState)(null),[r,c]=(0,o.useState)(!0),n=(0,o.useRef)(!1);(0,o.useEffect)(()=>{if(n.current)return;let e=localStorage.getItem("user");if(e&&!t)try{a(JSON.parse(e))}catch(e){console.error("Erro ao parsear usu\xe1rio do cache:",e),localStorage.removeItem("user")}n.current=!0},[t]),(0,o.useEffect)(()=>{let t=localStorage.getItem("ultimoCheck"),r=localStorage.getItem("loadingCheck"),o=Date.now()-parseInt(t||"0");(localStorage.getItem("user")||t||r)&&(!t||!(o>6e4))||(localStorage.removeItem("loadingCheck"),localStorage.removeItem("ultimoCheck"));let s=async()=>{localStorage.setItem("loadingCheck","true");try{let e=await u.$p.auth.getMe();console.log("Authenticated user:",e.data),a(e.data),localStorage.setItem("user",JSON.stringify(e.data)),localStorage.removeItem("loadingCheck"),localStorage.setItem("ultimoCheck",Date.now().toString()),await new Promise(e=>setTimeout(e,1e4))}catch(t){l.cookies.token.remove(),e.push("/auth/login")}finally{c(!1)}};if(r||o<1e4){c(!1);return}s()},[e]);let i=!!t;return{user:t,loading:r,isAuthenticated:i,logout:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];l.cookies.auth.clear(),a(null),localStorage.removeItem("user"),localStorage.removeItem("ultimoCheck"),localStorage.removeItem("loadingCheck"),t&&e.push("/auth/login")},updateUser:e=>{t&&a({...t,...e})}}}u=(c.then?(await c)():c)[0],r()}catch(e){r(e)}})}},e=>{var t=t=>e(e.s=t);e.O(0,[8122,4349,8441,1684,7358],()=>t(62320)),_N_E=e.O()}]);