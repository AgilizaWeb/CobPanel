(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89504,e=>{"use strict";var a=e.i(43476);e.s(["default",0,({type:e="text",id:r,name:t,placeholder:s,defaultValue:d,onChange:l,min:i,max:n,step:o,disabled:c=!1,success:u=!1,error:x=!1,hint:m,value:g,required:h,className:p="",...v})=>{let f=`h-11 w-full rounded-lg border px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 ${p}`;if("date"!==e&&(f+=" appearance-none"),c)f+=" text-gray-500 border-gray-300 cursor-not-allowed dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700";else if(x){if(f+=" text-error-800 border-error-500 focus:ring-3 focus:ring-error-500/10  dark:text-error-400 dark:border-error-500","string"==typeof x)return(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{...v,type:e,id:r,name:t,placeholder:s,defaultValue:d,onChange:l,className:f,min:i,max:n,step:o,disabled:c,value:g,required:h}),(0,a.jsx)("p",{className:"mt-1 text-xs text-error-500",children:x})]})}else u?f+=" text-success-500 border-success-400 focus:ring-success-500/10 focus:border-success-300  dark:text-success-400 dark:border-success-500":f+=" bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800";return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{...v,type:e,id:r,name:t,placeholder:s,value:g,defaultValue:d,onChange:l,min:i,max:n,required:h,step:o,disabled:c,className:f}),m&&(0,a.jsx)("p",{className:`mt-1.5 text-xs ${x?"text-error-500":u?"text-success-500":"text-gray-500"}`,children:m})]})}])},59544,e=>{"use strict";var a=e.i(43476);e.s(["default",0,({variant:e="primary",size:r="md",loading:t=!1,fullWidth:s=!1,className:d="",children:l,disabled:i,...n})=>{let o=["inline-flex items-center justify-center font-medium transition-colors rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2",{success:"bg-green-500 text-white hover:bg-green-600 focus:ring-green-500",primary:"bg-brand-500 text-white hover:bg-brand-600 focus:ring-brand-500 disabled:bg-brand-300",secondary:"bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-gray-500 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",danger:"bg-error-500 text-white hover:bg-error-600 focus:ring-error-500"}[e],{xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-base"}[r],s?"w-full":"",i||t?"opacity-50 cursor-not-allowed":"",d].join(" ");return(0,a.jsxs)("button",{className:o,disabled:i||t,...n,children:[t&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})}])},38853,e=>{"use strict";var a=e.i(33502);e.s(["EditIcon",()=>a.default])},90418,e=>{"use strict";var a=e.i(60466);e.s(["EyeIcon",()=>a.default])},25511,e=>{"use strict";var a=e.i(71645);let r=a.forwardRef(function({title:e,titleId:r,...t},s){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},t),e?a.createElement("title",{id:r},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))});e.s(["PlayIcon",0,r],25511)},35665,e=>{"use strict";var a=e.i(81783);e.s(["QrcodeIcon",()=>a.default])},50890,e=>{"use strict";var a=e.i(43476);e.i(35829);var r=e.i(38853),t=e.i(56770),s=e.i(90418),d=e.i(73648),d=d,l=e.i(57129),l=l,i=e.i(35665),n=e.i(59544),o=e.i(25511);e.s(["default",0,({size:e="md",variant:c="primary",onClick:u,className:x="",disabled:m=!1,type:g="button",title:h="Editar",icon:p="edit"})=>{let v=`${"edit"===p||"eye"===p||"reload"===p||"stop"===p||"qrcode"===p?"text-gray-400 hover:text-brand-500 dark:hover:text-brand-400":"text-red-500 dark:text-red-400"} rounded-md flex items-center justify-center transition-colors`;return(0,a.jsx)(n.default,{variant:c,size:e,onClick:()=>u&&u(),className:`${v} ${x}`,title:h,type:g,disabled:m,children:p&&(0,a.jsx)("span",{className:"flex items-center",children:"edit"===p?(0,a.jsx)(r.EditIcon,{className:"w-5 h-5 inline-block"}):"eye"===p?(0,a.jsx)(s.EyeIcon,{className:"w-5 h-5 inline-block"}):"reload"===p?(0,a.jsx)(d.default,{className:"w-5 h-5 inline-block"}):"stop"===p?(0,a.jsx)(l.default,{className:"w-5 h-5 inline-block"}):"qrcode"===p?(0,a.jsx)(i.QrcodeIcon,{className:"w-5 h-5 inline-block"}):"play"===p?(0,a.jsx)(o.PlayIcon,{className:"w-5 h-5 inline-block text-green-500"}):(0,a.jsx)(t.TrashBinIcon,{className:"w-5 h-5 inline-block"})})})}],50890)},58700,e=>{"use strict";var a=e.i(43476);let r=e=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:(0,a.jsx)("polyline",{points:"15 18 9 12 15 6"})}),t=e=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:(0,a.jsx)("polyline",{points:"9 18 15 12 9 6"})});var s=e.i(59544);e.s(["default",0,({currentPage:e,totalPages:d,onPageChange:l})=>(0,a.jsxs)("nav",{className:"flex justify-center items-center space-x-2",children:[(0,a.jsx)(s.default,{variant:"secondary",size:"sm",onClick:()=>l(e-1),disabled:1===e,children:(0,a.jsx)(r,{className:"h-5 w-5"})}),(()=>{let r=[],t=Math.max(1,e-2),i=Math.min(d,e+2);t>1&&(r.push((0,a.jsx)(s.default,{variant:1===e?"primary":"secondary",size:"sm",onClick:()=>l(1),className:"hidden sm:block",children:"1"},1)),t>2&&r.push((0,a.jsx)("span",{className:"px-2 py-2 text-gray-500 dark:text-gray-400",children:"..."},"start-ellipsis")));for(let d=t;d<=i;d++)r.push((0,a.jsx)(s.default,{variant:e===d?"primary":"secondary",size:"sm",onClick:()=>l(d),children:d},d));return i<d&&(i<d-1&&r.push((0,a.jsx)("span",{className:"px-2 py-2 text-gray-500 dark:text-gray-400",children:"..."},"end-ellipsis")),r.push((0,a.jsx)(s.default,{variant:e===d?"primary":"secondary",size:"sm",onClick:()=>l(d),className:"hidden sm:block",children:d},d))),r})(),(0,a.jsx)(s.default,{variant:"secondary",size:"sm",onClick:()=>l(e+1),disabled:e===d,children:(0,a.jsx)(t,{className:"h-5 w-5"})})]})],58700)},38434,e=>{"use strict";let a,r,t;var s=e.i(43476),d=e.i(71645),l=e.i(23115);e.i(35829);var i=e.i(6571),i=i;function n({id:n,mode:o,onChange:c,label:u,defaultDate:x,dateFormat:m="d/m/Y",placeholder:g,onClickHj:h,onClickMes:p,onClickAno:v,onClickClean:f}){let[y,j]=(0,d.useState)(!1);return(h||(h=e=>{e&&e.setDate(new Date),e.close()}),f||(f=e=>{e&&e.clear(),e.close()}),(0,d.useEffect)(()=>{j(!0)},[]),(0,d.useEffect)(()=>{y&&(async()=>{try{a=(await e.A(97813)).default,r=(await e.A(72952)).Portuguese;try{t=(await e.A(47793)).default}catch(e){t=void 0}let s=a(`#${n}`,{mode:o||"single",static:!1,dateFormat:m,defaultDate:x,onChange:c,locale:r,plugins:t?[t({button:[{label:"Hoje"},...p?[{label:"Este M√™s"}]:[],...v?[{label:"Este Ano"}]:[],{label:"Limpar"}],onClick:[(e,a)=>{0===e&&h(a)},...p?[(e,a)=>{1===e&&p(a)}]:[],...v?[(e,a)=>{e===(p?2:1)&&v(a)}]:[],(e,a)=>{e===1+ +!!p+ +!!v&&f(a)}]})]:[]});return a.l10ns?.default&&(a.l10ns.default.firstDayOfWeek=1),()=>{Array.isArray(s)||s.destroy()}}catch(e){console.error("Erro ao carregar flatpickr:",e)}})()},[y,o,c,n,x,m,v,p,h,f]),y)?(0,s.jsxs)("div",{children:[u&&(0,s.jsx)(l.default,{htmlFor:n,children:u}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{id:n,placeholder:g,className:"h-11 w-full rounded-lg border appearance-none px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3  dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30  bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-brand-500/20 dark:border-gray-700  dark:focus:border-brand-800"}),(0,s.jsx)("span",{className:"absolute text-gray-500 -translate-y-1/2 pointer-events-none right-3 top-1/2 dark:text-gray-400",children:(0,s.jsx)(i.default,{className:"size-6"})})]})]}):(0,s.jsxs)("div",{children:[u&&(0,s.jsx)(l.default,{htmlFor:n,children:u}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{id:n,placeholder:g,className:"h-11 w-full rounded-lg border appearance-none px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-brand-500/20 dark:border-gray-700 dark:focus:border-brand-800",disabled:!0}),(0,s.jsx)("span",{className:"absolute text-gray-500 -translate-y-1/2 pointer-events-none right-3 top-1/2 dark:text-gray-400",children:(0,s.jsx)(i.default,{className:"size-6"})})]})]})}e.s(["default",()=>n],38434)},75889,e=>{"use strict";var a=e.i(43476),r=e.i(71645),t=e.i(52455),s=e.i(59544),d=e.i(50890);e.s(["default",0,({venda:e,onEdit:l,onDelete:i,onViewInvoices:n})=>{let[o,c]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-5 hover:shadow-lg transition-shadow duration-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:["Venda #",e.id]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${(e=>{switch(e){case"PAGO":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"PENDENTE":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}})(e.status)}`,children:(e=>{switch(e){case"PAGO":return"Pago";case"PENDENTE":return"Pendente";default:return e}})(e.status)}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.uuid.slice(0,8),"..."]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Cliente: "}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.cliente?.nome||`ID: ${e.clienteId}`})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Vendedor: "}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.vendedor?.nome||`ID: ${e.vendedorId}`})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,a.jsx)(d.default,{variant:"secondary",size:"xs",onClick:n,title:"Ver Faturas",icon:"eye"}),(0,a.jsx)(d.default,{variant:"secondary",size:"xs",onClick:l,title:"Editar Venda",icon:"edit"}),(0,a.jsx)(d.default,{title:"Excluir Venda",icon:"delete",variant:"secondary",size:"xs",onClick:i})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Valor Unit√°rio"}),(0,a.jsx)("dd",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(0,t.formatCurrency)(e.valor)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Valor Total"}),(0,a.jsx)("dd",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:(0,t.formatCurrency)(e.valorTotal)})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data de In√≠cio"}),(0,a.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:(0,t.formatDate)(e.inicio)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data de Fim"}),(0,a.jsx)("dd",{className:"text-sm text-gray-900 dark:text-white",children:(0,t.formatDate)(e.fim)})]})]}),e.quantidadeRecorrencia>0&&(0,a.jsxs)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-2",children:"üìÖ Venda Recorrente"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 dark:text-blue-400",children:"Intervalo: "}),(0,a.jsxs)("span",{className:"font-medium text-blue-900 dark:text-blue-200",children:[e.recorrencia," dias"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-blue-700 dark:text-blue-400",children:"Repeti√ß√µes: "}),(0,a.jsx)("span",{className:"font-medium text-blue-900 dark:text-blue-200",children:e.quantidadeRecorrencia})]})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-blue-700 dark:text-blue-400",children:["Total de cobran√ßas: ",e.quantidadeRecorrencia+1]})]})]}),e.gateway&&(0,a.jsx)("div",{className:`mb-${e.produtos&&e.produtos.length>0?"4":"0"} p-3 bg-gray-50 dark:bg-gray-700 rounded-lg`,children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Gateway: "}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.gateway.nome})]})}),e.produtos&&e.produtos.length>0&&(0,a.jsxs)("div",{className:"mb-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Produtos (",e.produtos.length,")"]}),(0,a.jsx)(s.default,{variant:"secondary",size:"sm",onClick:()=>c(!o),className:"text-xs",children:o?"Ocultar":"Mostrar"})]}),o&&(0,a.jsx)("div",{className:"space-y-2",children:e.produtos?.map(e=>(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-3",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.produto.nome}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Qtd:"}),(0,a.jsx)("span",{className:"ml-1 text-gray-900 dark:text-white",children:e.quantidade})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Unit:"}),(0,a.jsx)("span",{className:"ml-1 text-gray-900 dark:text-white",children:(0,t.formatCurrency)(e.valorUnitario)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Total:"}),(0,a.jsx)("span",{className:"ml-1 font-medium text-green-600 dark:text-green-400",children:(0,t.formatCurrency)(e.valorTotal)})]})]})]})},e.id))})]})]})}])},9129,e=>e.a(async(a,r)=>{try{var t=e.i(43476),s=e.i(71645),d=e.i(77919),l=e.i(27682),i=e.i(5828),n=e.i(62720),o=e.i(92512),c=e.i(74186),u=e.i(59544),x=e.i(89504),m=e.i(23115),g=e.i(67073),h=e.i(52455),p=e.i(5766),v=e.i(38434),f=a([d,l,i,n,o,c]);[d,l,i,n,o,c]=f.then?(await f)():f;let y=[{value:"PIX",label:"PIX"},{value:"BOLETO",label:"Boleto"}],j=[{value:"PENDENTE",label:"Pendente"},{value:"PAGO",label:"Pago"}];e.s(["default",0,({venda:e,onSubmit:a,onCancel:r})=>{let[f,b]=(0,s.useState)({valor:e?.valor||0,valorTotal:e?.valorTotal||0,inicio:e?.inicio?new Date(e.inicio):new Date,clienteId:e?.clienteId||0,vendedorId:e?.vendedorId||0,type:e?.type||"PIX",produtos:e?.produtos||[],status:e?.status||"PENDENTE",recorrencia:e?.recorrencia||0,quantidadeRecorrencia:e?.quantidadeRecorrencia||0,gatewayId:e?.gatewayId||void 0,conexaoId:e?.conexaoId||void 0}),[N,k]=(0,s.useState)([]),[w,C]=(0,s.useState)([]),[I,S]=(0,s.useState)([]),[E,P]=(0,s.useState)([]),[D,q]=(0,s.useState)([]),[R,V]=(0,s.useState)(null),[$,T]=(0,s.useState)(!0),[z,F]=(0,s.useState)(!1),[A,O]=(0,s.useState)(e?.valor?(0,h.formatCurrency)(e.valor).replace("R$","").trim():""),B=R?.role==="VENDEDOR";(0,s.useEffect)(()=>{(async()=>{try{T(!0);let a=await c.authService.getMe();V(a.data);let[r,t,s,u]=await Promise.all([d.clienteService.list({limit:100}),l.produtoService.list({limit:100}),i.gatewayService.list({limit:100}),o.conexaoService.list({limit:100})]);if(k(r.data||[]),C(t.data||[]),S(s.data||[]),P(u.data||[]),a.data?.role!=="VENDEDOR")try{let e=await n.vendedorService.list({limit:100});q(e.data||[])}catch(e){console.error("Erro ao carregar vendedores:",e)}!e&&a.data&&"VENDEDOR"===a.data.role&&b(e=>({...e,vendedorId:a.data.id}))}catch(e){console.error("Erro ao carregar dados:",e),p.toast.error("Erro ao carregar dados necess√°rios")}finally{T(!1)}})()},[e]),(0,s.useEffect)(()=>{let e=f.valor;f.recorrencia&&f.recorrencia>0&&f.quantidadeRecorrencia&&f.quantidadeRecorrencia>0&&(e=f.valor*(f.quantidadeRecorrencia+1)),e!==f.valorTotal&&b(a=>({...a,valorTotal:e}))},[f.valor,f.recorrencia,f.quantidadeRecorrencia,f.valorTotal]);let L=async e=>{if(e.preventDefault(),!f.inicio)return void p.toast.error("Data de in√≠cio √© obrigat√≥ria");if(!f.clienteId||f.clienteId<=0)return void p.toast.error("Cliente √© obrigat√≥rio");if(!f.vendedorId||f.vendedorId<=0)return void p.toast.error("Vendedor √© obrigat√≥rio");if(!f.valor||f.valor<=0)return void p.toast.error("Valor deve ser maior que zero");let r=I.find(e=>e.isDefault);if(!f.gatewayId&&!r)return void p.toast.error("Gateway de pagamento √© obrigat√≥rio quando n√£o h√° gateway padr√£o");if(f.recorrencia&&f.recorrencia>0){if(!f.quantidadeRecorrencia||f.quantidadeRecorrencia<1)return void p.toast.error("Quantidade de recorr√™ncias deve ser pelo menos 1");if(f.recorrencia<1)return void p.toast.error("Intervalo de recorr√™ncia deve ser pelo menos 1 dia")}if(f.produtos&&f.produtos.some(e=>!e.produtoId||!e.quantidade))return void p.toast.error("Todos os campos dos produtos s√£o obrigat√≥rios");try{F(!0),await a(f)}catch(e){console.error("Erro ao salvar venda:",e)}finally{F(!1)}},M=(e,a,r)=>{let t=[...f.produtos||[]];t[e]={...t[e],[a]:r},b(e=>({...e,produtos:t}))},Q=N.map(e=>({value:e.id.toString(),label:`${e.nome} ${e.cpfCnpj?`(${e.cpfCnpj})`:""}`})),G=w.map(e=>({value:e.id.toString(),label:`${e.nome} - ${(0,h.formatCurrency)(e.valor)}`})),W=I.map(e=>({value:e.id.toString(),label:`${e.nome} (${e.gateway}) ${e.isDefault?"(Padr√£o)":""}`})),U=E.map(e=>({value:e.id.toString(),label:`${e.nome} ${e.isDefault?"(Padr√£o)":""}`})),X=D.map(e=>({value:e.id.toString(),label:`${e.nome} (${e.email})`}));return $?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{children:"Carregando dados..."})]})}):(0,t.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"clienteId",children:"Cliente *"}),(0,t.jsx)(g.default,{value:Q.find(e=>e.value===f.clienteId.toString()),onChange:e=>{b(a=>({...a,clienteId:e?parseInt(e.value):0}))},options:Q,placeholder:"Selecione um cliente",isClearable:!1})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"vendedor",children:"Vendedor *"}),B?(0,t.jsx)(x.default,{id:"vendedor",type:"text",value:R?`${R.nome} (${R.email})`:"Carregando...",readOnly:!0,className:"bg-gray-50"}):(0,t.jsx)(g.default,{value:X.find(e=>e.value===f.vendedorId?.toString()),onChange:e=>{b(a=>({...a,vendedorId:e?parseInt(e.value):0}))},options:X,placeholder:"Selecione um vendedor",isClearable:!1})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"type",children:"Tipo *"}),(0,t.jsx)(g.default,{value:y.find(e=>e.value===f.type),onChange:e=>{b(a=>({...a,type:e?.value||"PIX"}))},options:y,isClearable:!1})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"valor",children:"Valor *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute z-1 left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-300",children:"R$"}),(0,t.jsx)(x.default,{id:"valor",type:"text",className:"pl-9",value:A,onChange:e=>{let a=e.target.value.replace(/\D/g,"");if(""===a){O(""),b(e=>({...e,valor:0}));return}let r=(0,h.formatCurrencyInput)(a);O(r),b(e=>({...e,valor:(0,h.parseCurrencyInput)(a)}))},placeholder:"0,00",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"inicio",children:"Data de In√≠cio *"}),(0,t.jsx)(v.default,{id:"data",onChange:e=>{e[0]&&b({...f,inicio:e[0]})},defaultDate:new Date(f.inicio||new Date)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"status",children:"Status *"}),(0,t.jsx)(g.default,{value:j.find(e=>e.value===f.status),onChange:e=>{b(a=>({...a,status:e?.value||"PENDENTE"}))},options:j,isClearable:!1})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"gatewayId",children:"Gateway de Pagamento"}),(0,t.jsx)(g.default,{value:W.find(e=>e.value===f.gatewayId?.toString()),onChange:e=>{b(a=>({...a,gatewayId:e?parseInt(e.value):void 0}))},options:W,placeholder:"Selecione um gateway (opcional)",isClearable:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"conexaoId",children:"Conex√£o WhatsApp"}),(0,t.jsx)(g.default,{value:U.find(e=>e.value===f.conexaoId?.toString()),onChange:e=>{b(a=>({...a,conexaoId:e?parseInt(e.value):void 0}))},options:U,placeholder:"Selecione uma conex√£o (opcional)",isClearable:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50 dark:bg-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{title:"Venda recorrente",type:"checkbox",id:"recorrencia",checked:(f.recorrencia||0)>0,onChange:e=>b(a=>({...a,recorrencia:30*!!e.target.checked,quantidadeRecorrencia:+!!e.target.checked})),className:"rounded border-gray-300"}),(0,t.jsx)(m.default,{htmlFor:"recorrencia",className:"font-semibold",children:"Venda recorrente"})]}),(f.recorrencia||0)>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"recorrencia",children:"Intervalo (dias) *"}),(0,t.jsx)(x.default,{id:"recorrencia",type:"number",min:1,value:f.recorrencia||30,onChange:e=>b(a=>({...a,recorrencia:parseInt(e.target.value)||30})),placeholder:"30"}),(0,t.jsx)("small",{className:"text-gray-600 dark:text-gray-400",children:"Intervalo em dias entre cada cobran√ßa"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"quantidadeRecorrencia",children:"Quantidade de Repeti√ß√µes *"}),(0,t.jsx)(x.default,{id:"quantidadeRecorrencia",type:"number",min:1,value:f.quantidadeRecorrencia||1,onChange:e=>b(a=>({...a,quantidadeRecorrencia:parseInt(e.target.value)||1})),placeholder:"1"}),(0,t.jsx)("small",{className:"text-gray-600 dark:text-gray-400",children:"Quantas vezes a cobran√ßa se repetir√° ap√≥s a primeira"})]})]}),f.inicio&&f.recorrencia&&f.quantidadeRecorrencia&&(0,t.jsxs)("div",{className:"mt-4 p-3  border rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-600 dark:text-gray-400 mb-2",children:"Cronograma de Cobran√ßas:"}),(0,t.jsx)("div",{className:"space-y-1",children:Array.from({length:f.quantidadeRecorrencia+1},(e,a)=>{let r=new Date(f.inicio);return r.setDate(r.getDate()+a*(f.recorrencia||30)),(0,t.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-500",children:[(0,t.jsxs)("span",{className:"font-medium",children:[a+1,"¬™ cobran√ßa:"]})," ",r.toLocaleDateString("pt-BR"),0===a&&(0,t.jsx)("span",{className:"text-green-600 ml-2",children:"(Primeira cobran√ßa)"})]},a)})}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("strong",{children:"Total de cobran√ßas:"})," ",f.quantidadeRecorrencia+1," (",(0,h.formatCurrency)((f.quantidadeRecorrencia+1)*f.valor),")"]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(m.default,{children:"Produtos (opcional)"}),(0,t.jsx)(u.default,{type:"button",onClick:()=>{let e=[...f.produtos||[],{produtoId:0,quantidade:1}];b(a=>({...a,produtos:e}))},variant:"secondary",size:"sm",children:"Adicionar Produto"})]}),f.produtos&&f.produtos.map((e,a)=>(0,t.jsxs)("div",{className:"flex gap-4 items-end p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(m.default,{htmlFor:`produto-${a}`,children:"Produto"}),(0,t.jsx)(g.default,{value:G.find(a=>a.value===e.produtoId.toString()),onChange:e=>{M(a,"produtoId",e?parseInt(e.value):0)},options:G,placeholder:"Selecione um produto",isClearable:!1})]}),(0,t.jsxs)("div",{className:"w-32",children:[(0,t.jsx)(m.default,{htmlFor:`quantidade-${a}`,children:"Quantidade"}),(0,t.jsx)(x.default,{id:`quantidade-${a}`,type:"number",min:1,value:e.quantidade,onChange:e=>M(a,"quantidade",parseInt(e.target.value)||1)})]}),(0,t.jsx)(u.default,{type:"button",onClick:()=>{let e;return e=(f.produtos||[]).filter((e,r)=>r!==a),void b(a=>({...a,produtos:e}))},variant:"danger",size:"sm",children:"Remover"})]},a))]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.default,{htmlFor:"valorTotal",children:"Valor Total"}),(0,t.jsx)(x.default,{id:"valorTotal",type:"text",value:(0,h.formatCurrency)(f.valorTotal),readOnly:!0,className:"bg-gray-50"})]}),(0,t.jsxs)("div",{className:"flex gap-4 pt-6",children:[r&&(0,t.jsx)(u.default,{type:"button",variant:"secondary",onClick:r,className:"flex-1",children:"Cancelar"}),(0,t.jsx)(u.default,{type:"submit",disabled:z,variant:"primary",className:"flex-1",children:z?"Salvando...":e?"Atualizar":"Criar Venda"})]})]})}]),r()}catch(e){r(e)}},!1),61784,e=>e.a(async(a,r)=>{try{var t=e.i(43476),s=e.i(71645),d=e.i(18566),l=e.i(5766),i=e.i(7481),n=e.i(75889),o=e.i(59629),c=e.i(9129),u=e.i(59544),x=e.i(89504),m=e.i(58700),g=e.i(23115),h=a([i,c]);function p(){let e=(0,d.useRouter)(),[a,r]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[v,f]=(0,s.useState)(""),[y,j]=(0,s.useState)(1),[b,N]=(0,s.useState)(0),[k,w]=(0,s.useState)(!1),[C,I]=(0,s.useState)(null),[S,E]=(0,s.useState)(9),P=(0,s.useCallback)(async()=>{try{p(!0);let e=await i.vendaService.list({page:y,limit:S,search:v});r(e.data),e.pagination?N(e.pagination.pages):N(Math.ceil((e.data?.length||0)/S))}catch(e){l.toast.error("Erro ao carregar vendas")}finally{p(!1)}},[y,v,S]);(0,s.useEffect)(()=>{P()},[P]);let D=async e=>{if(window.confirm("Tem certeza que deseja excluir esta venda?"))try{await i.vendaService.delete(e),l.toast.success("Venda exclu√≠da com sucesso"),P()}catch(e){l.toast.error("Erro ao excluir venda")}},q=async e=>{try{C?(await i.vendaService.update(C.id,e),l.toast.success("Venda atualizada com sucesso")):(await i.vendaService.create(e),l.toast.success("Venda criada com sucesso")),w(!1),I(null),P()}catch(e){l.toast.error("Erro ao salvar venda")}};return(0,t.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Vendas"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie suas vendas e contratos"})]}),(0,t.jsx)(u.default,{variant:"primary",onClick:()=>{I(null),w(!0)},children:"Nova Venda"})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between mb-6",children:(0,t.jsx)(x.default,{placeholder:"Buscar vendas...",value:v,onChange:e=>{f(e.target.value),j(1)},className:"max-w-xs"})}),(0,t.jsxs)("div",{className:"flex justify-between mb-4 gap-2 flex-wrap",children:[(0,t.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,t.jsx)(g.default,{className:"flex items-center mb-0 h-full",children:"Quantidade por p√°gina"}),(0,t.jsx)(x.default,{className:"max-w-24",defaultValue:S,max:100,min:1,onChange:e=>{let a=Number(e.target.value)||9;E(a),j(1)}})]}),(0,t.jsx)(m.default,{currentPage:y,totalPages:b,onPageChange:j})]})]})]}),h?(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-48"},e))}):(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.length>0?a.map(a=>(0,t.jsx)(n.default,{venda:a,onEdit:()=>{I(a),w(!0)},onDelete:()=>D(a.id),onViewInvoices:()=>{var r;return r=a.id,void e.push(`/dashboard/empresa/financeiro/vendas/vendas-finais/${r}`)}},a.id)):(0,t.jsx)("div",{className:"col-span-full text-center py-12",children:(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma venda encontrada."})})}),b>1&&(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)("div",{className:"flex justify-end mb-4 gap-2 flex-wrap",children:(0,t.jsx)(m.default,{currentPage:y,totalPages:b,onPageChange:j})})}),(0,t.jsx)(o.Modal,{isOpen:k,onClose:()=>{w(!1),I(null)},className:"max-w-[900px] m-4",children:(0,t.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,t.jsxs)("div",{className:"px-2 pr-14",children:[(0,t.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:C?"Editar Venda":"Nova Venda"}),(0,t.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:C?"Atualize as informa√ß√µes da venda.":"Preencha os dados para criar uma nova venda."})]}),(0,t.jsx)(c.default,{venda:C,onSubmit:q,onCancel:()=>{w(!1),I(null)}})]})})]})}[i,c]=h.then?(await h)():h,e.s(["default",()=>p]),r()}catch(e){r(e)}},!1),97813,e=>{e.v(a=>Promise.all(["static/chunks/67855d6bfd34a5bb.js"].map(a=>e.l(a))).then(()=>a(11229)))},72952,e=>{e.v(a=>Promise.all(["static/chunks/373ba0eb9f1d9e61.js"].map(a=>e.l(a))).then(()=>a(56703)))},47793,e=>{e.v(a=>Promise.all(["static/chunks/0f1833b87bc4e435.js"].map(a=>e.l(a))).then(()=>a(43625)))}]);