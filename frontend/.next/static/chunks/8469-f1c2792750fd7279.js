"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8469],{8723:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(95155);r(12115);let o=e=>{let{variant:t="light",color:r="primary",size:o="md",startIcon:l,className:n,endIcon:c,children:i}=e,s={light:{primary:"bg-brand-50 text-brand-500 dark:bg-brand-500/15 dark:text-brand-400",success:"bg-success-50 text-success-600 dark:bg-success-500/15 dark:text-success-500",error:"bg-error-50 text-error-600 dark:bg-error-500/15 dark:text-error-500",warning:"bg-warning-50 text-warning-600 dark:bg-warning-500/15 dark:text-orange-400",info:"bg-blue-light-50 text-blue-light-500 dark:bg-blue-light-500/15 dark:text-blue-light-500",light:"bg-gray-100 text-gray-700 dark:bg-white/5 dark:text-white/80",dark:"bg-gray-500 text-white dark:bg-white/5 dark:text-white"},solid:{primary:"bg-brand-500 text-white dark:text-white",success:"bg-success-500 text-white dark:text-white",error:"bg-error-500 text-white dark:text-white",warning:"bg-warning-500 text-white dark:text-white",info:"bg-blue-light-500 text-white dark:text-white",light:"bg-gray-400 dark:bg-white/5 text-white dark:text-white/80",dark:"bg-gray-700 text-white dark:text-white"}}[t][r];return(0,a.jsxs)("span",{className:"".concat("inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full font-medium"," ").concat({sm:"text-theme-xs",md:"text-sm"}[o]," ").concat(s," ").concat(n),children:[l&&(0,a.jsx)("span",{className:"mr-1",children:l}),i,c&&(0,a.jsx)("span",{className:"ml-1",children:c})]})}},15239:(e,t,r)=>{r.d(t,{default:()=>o.a});var a=r(54652),o=r.n(a)},30304:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(95155);r(12115);var o=r(75889);let l=e=>{let{htmlFor:t,children:r,className:l}=e;return(0,a.jsx)("label",{htmlFor:t,className:(0,o.QP)("mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400",l),children:r})}},41405:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{d:()=>m});var o=r(12115),l=r(20063),n=r(9829),c=r(49156),i=r(6829),s=r(22663),d=r(90854),u=r(25753),g=e([c,d]);function m(){(0,l.useRouter)();let{user:e,isAuthenticated:t}=(0,d.A)(),r=(0,u.zr)(),[a,g]=(0,o.useState)([]),[m,f]=(0,o.useState)(!0),[h,x]=(0,o.useState)(null),[b,k]=(0,o.useState)(!1),[p,y]=(0,o.useState)(null),v=(0,o.useRef)(!1);(0,o.useEffect)(()=>{let a=i.cookies.token.get();if(!a||!t||!e){x(e=>(e&&(e.close(),k(!1)),null)),v.current=!1;return}if(v.current)return;if(!r)return void console.warn("[Socket.IO] backendUrl n\xe3o configurada");if(v.current)return;v.current=!0,console.log("[Socket.IO] Inicializando conex\xe3o com:",r);let o=(0,n.io)(r,{auth:{token:a},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,reconnectionDelayMax:5e3,timeout:2e4,forceNew:!1});return o.on("connect",()=>{console.log("[Socket.IO Tickets] Conectado"),k(!0)}),o.on("disconnect",()=>{console.log("[Socket.IO Tickets] Desconectado"),k(!1)}),o.on("connect_error",e=>{console.error("[Socket.IO Tickets] Erro de conex\xe3o:",e),k(!1)}),o.on("ticket:nova-mensagem",e=>{if(console.log("[Socket.IO Tickets] Nova mensagem recebida:",e),p!==e.ticketId){var t;let r=(null==(t=e.ticket)?void 0:t.titulo)||"Ticket";s.Ay.success("Nova mensagem no ticket: ".concat(r),{duration:5e3})}}),o.on("ticket:status-atualizado",e=>{console.log("[Socket.IO Tickets] Status atualizado:",e),g(t=>{let r=t.findIndex(t=>t.id===e.ticketId);if(r>=0){let a=[...t];return a[r]={...a[r],status:e.status},a}return t})}),x(o),()=>{o&&o.close(),v.current=!1}},[t,e,r]);let w=(0,o.useCallback)(async e=>{try{f(!0);let t=await c.$p.ticket.list(e);g(t.data)}catch(e){console.error("Erro ao carregar tickets:",e),s.Ay.error("Erro ao carregar tickets")}finally{f(!1)}},[]),D=(0,o.useCallback)(async e=>{try{return(await c.$p.ticket.getById(e)).data}catch(e){return console.error("Erro ao carregar ticket:",e),s.Ay.error("Erro ao carregar ticket"),null}},[]),S=(0,o.useCallback)(e=>{h&&b&&(h.emit("ticket:join",{ticketId:e}),y(e))},[h,b]),j=(0,o.useCallback)(e=>{h&&b&&(h.emit("ticket:leave",{ticketId:e}),p===e&&y(null))},[h,b,p]);return{tickets:a,loading:m,isConnected:b,currentTicketId:p,loadTickets:w,loadTicket:D,joinTicketRoom:S,leaveTicketRoom:j}}[c,d]=g.then?(await g)():g,a()}catch(e){a(e)}})},41754:(e,t,r)=>{r.d(t,{D:()=>c,ThemeProvider:()=>n});var a=r(95155),o=r(12115);let l=(0,o.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,o.useState)("light"),[c,i]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{n(localStorage.getItem("theme")||"light"),i(!0)},[]),(0,o.useEffect)(()=>{c&&(localStorage.setItem("theme",r),"dark"===r?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))},[r,c]),(0,a.jsx)(l.Provider,{value:{theme:r,isDark:"dark"===r,toggleTheme:()=>{n(e=>"light"===e?"dark":"light")}},children:t})},c=()=>{let e=(0,o.useContext)(l);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},43698:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(95155);r(12115);var o=r(37750),l=r(41754);function n(e){let{error:t,className:r="",...n}=e,{isDark:c}=(0,l.D)();return(0,a.jsxs)("div",{className:r,children:[(0,a.jsx)(o.Ay,{...n,styles:{control:(e,r)=>({...e,backgroundColor:c?"#1F2937":"#fff",borderColor:t?"#EF4444":r.isFocused?"#3B82F6":c?"#374151":"#D1D5DB",borderRadius:"0.375rem",boxShadow:r.isFocused?"0 0 0 2px rgba(59, 130, 246, 0.5)":"none","&:hover":{borderColor:r.isFocused?"#3B82F6":c?"#4B5563":"#9CA3AF"},minHeight:"2.5rem"}),menu:e=>({...e,backgroundColor:c?"#1F2937":"#fff",borderColor:c?"#374151":"#D1D5DB",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?c?"#3B82F6":"#2563EB":t.isFocused?c?"#374151":"#F3F4F6":"transparent",color:t.isSelected?"#fff":c?"#D1D5DB":"#111827",cursor:"pointer","&:active":{backgroundColor:c?"#2563EB":"#3B82F6"}}),singleValue:e=>({...e,color:c?"#D1D5DB":"#111827"}),input:e=>({...e,color:c?"#D1D5DB":"#111827"}),placeholder:e=>({...e,color:c?"#6B7280":"#9CA3AF"}),indicatorSeparator:e=>({...e,backgroundColor:c?"#374151":"#D1D5DB"}),dropdownIndicator:e=>({...e,color:c?"#6B7280":"#9CA3AF","&:hover":{color:c?"#D1D5DB":"#4B5563"}}),clearIndicator:e=>({...e,color:c?"#6B7280":"#9CA3AF","&:hover":{color:c?"#D1D5DB":"#4B5563"}})},classNamePrefix:"react-select",className:t?"react-select-error":""}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:t})]})}},54652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return i},getImageProps:function(){return c}});let a=r(28140),o=r(75040),l=r(81356),n=a._(r(71124));function c(e){let{props:t}=(0,o.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let i=l.Image},60848:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{A:()=>s});var o=r(95155);r(12115);var l=r(90854),n=r(15239),c=r(25753),i=e([l]);function s(e){var t,r;let{mensagem:a}=e,{user:i}=(0,l.A)(),s=a.userId===(null==i?void 0:i.id),d=(null==(t=a.user)?void 0:t.role)==="SUPERADMIN";return(0,o.jsx)("div",{className:"flex ".concat(s?"justify-end":"justify-start"," mb-4"),children:(0,o.jsxs)("div",{className:"flex flex-col max-w-[70%] ".concat(s?"items-end":"items-start"),children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1 ".concat(s?"flex-row-reverse":""),children:[(0,o.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:(null==(r=a.user)?void 0:r.nome)||"Usu\xe1rio"}),d&&(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 font-medium",children:"ADMIN"}),(0,o.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:function(e){try{let t=new Date(e),r=new Date,a=Math.floor((r.getTime()-t.getTime())/1e3);if(a<60)return"agora";if(a<3600)return"".concat(Math.floor(a/60)," min atr\xe1s");if(a<86400)return"".concat(Math.floor(a/3600)," hr atr\xe1s");let o=new Date;o.setHours(0,0,0,0);let l=new Date(t);if(l.setHours(0,0,0,0),l.getTime()===o.getTime())return"Hoje \xe0s ".concat(t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}));let n=new Date(o);if(n.setDate(n.getDate()-1),l.getTime()===n.getTime())return"Ontem \xe0s ".concat(t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}));return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}}(a.createdAt)})]}),a.anexos&&Array.isArray(a.anexos)&&a.anexos.length>0&&(0,o.jsx)("div",{className:"mt-2 ".concat(s?"text-right":"text-left"),children:(0,o.jsx)("div",{className:"flex flex-wrap gap-2",children:a.anexos.map((e,t)=>{var r;let a=null==(r=e.tipo)?void 0:r.startsWith("image/"),l=(0,c.WE)(),i=e.url?"".concat(null==l?void 0:l.backendUrl).concat(e.url):"#";return console.log("fileUrl:",i),(0,o.jsxs)("div",{className:"flex flex-col gap-1",children:[a?(0,o.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"block",children:(0,o.jsx)(n.default,{src:i,alt:e.nome||"Anexo ".concat(t+1),className:"max-w-[200px] max-h-[200px] rounded-lg object-cover border border-gray-200 dark:border-gray-600 hover:opacity-80 transition-opacity cursor-pointer",width:200,height:200})}):(0,o.jsxs)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs px-3 py-1.5 rounded-lg transition-colors ".concat(s?"bg-blue-400/20 text-blue-100 hover:bg-blue-400/30":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"),children:[(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.nome||"Anexo ".concat(t+1)]}),a&&(0,o.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-[200px]",children:e.nome||"Anexo ".concat(t+1)})]},t)})})}),(0,o.jsx)("div",{className:"rounded-2xl px-4 py-3 shadow-sm ".concat(s?"bg-blue-500 text-white rounded-tr-sm":d?"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 text-gray-900 dark:text-white rounded-tl-sm":"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white rounded-tl-sm"),children:(0,o.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words",children:a.mensagem})})]})})}l=(i.then?(await i)():i)[0],a()}catch(e){a(e)}})},76733:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(95155);r(12115);let o=e=>{let{children:t,size:r="md",variant:o="primary",startIcon:l,endIcon:n,onClick:c,className:i="",disabled:s=!1,type:d="button"}=e;return(0,a.jsxs)("button",{className:"inline-flex items-center justify-center font-medium gap-2 rounded-lg transition ".concat(i," ").concat({sm:"px-4 py-3 text-sm",md:"px-5 py-3.5 text-sm"}[r]," ").concat({primary:"bg-brand-500 text-white shadow-theme-xs hover:bg-brand-600 disabled:bg-brand-300",outline:"bg-white text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-white/[0.03] dark:hover:text-gray-300"}[o]," ").concat(s?"cursor-not-allowed opacity-50":""),onClick:c,disabled:s,type:d,children:[l&&(0,a.jsx)("span",{className:"flex items-center",children:l}),t,n&&(0,a.jsx)("span",{className:"flex items-center",children:n})]})}},83011:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return o}});let a=r(12115);function o(e,t){let r=(0,a.useRef)(null),o=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=r.current;e&&(r.current=null,e());let t=o.current;t&&(o.current=null,t())}else e&&(r.current=l(e,a)),t&&(o.current=l(t,a))},[e,t])}function l(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},86948:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(95155);r(12115);let o=e=>{let{children:t,className:r=""}=e;return(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 ".concat(r),children:t})}},90854:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{A:()=>s});var o=r(12115),l=r(20063),n=r(49156),c=r(6829),i=e([n]);function s(){let e=(0,l.useRouter)(),[t,r]=(0,o.useState)(null),[a,i]=(0,o.useState)(!0),s=(0,o.useRef)(!1);(0,o.useEffect)(()=>{if(s.current)return;let e=localStorage.getItem("user");if(e&&!t)try{r(JSON.parse(e))}catch(e){console.error("Erro ao parsear usu\xe1rio do cache:",e),localStorage.removeItem("user")}s.current=!0},[t]),(0,o.useEffect)(()=>{let t=localStorage.getItem("ultimoCheck"),a=localStorage.getItem("loadingCheck"),o=Date.now()-parseInt(t||"0");(localStorage.getItem("user")||t||a)&&(!t||!(o>6e4))||(localStorage.removeItem("loadingCheck"),localStorage.removeItem("ultimoCheck"));let l=async()=>{localStorage.setItem("loadingCheck","true");try{let e=await n.$p.auth.getMe();console.log("Authenticated user:",e.data),r(e.data),localStorage.setItem("user",JSON.stringify(e.data)),localStorage.removeItem("loadingCheck"),localStorage.setItem("ultimoCheck",Date.now().toString()),await new Promise(e=>setTimeout(e,1e4))}catch(t){c.cookies.token.remove(),e.push("/auth/login")}finally{i(!1)}};if(a||o<1e4)return void i(!1);l()},[e]);let d=!!t;return{user:t,loading:a,isAuthenticated:d,logout:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];c.cookies.auth.clear(),r(null),localStorage.removeItem("user"),localStorage.removeItem("ultimoCheck"),localStorage.removeItem("loadingCheck"),t&&e.push("/auth/login")},updateUser:e=>{t&&r({...t,...e})}}}n=(i.then?(await i)():i)[0],a()}catch(e){a(e)}})},94325:(e,t,r)=>{r.d(t,{F5:()=>o,ON:()=>c,Yq:()=>n,h4:()=>l,vv:()=>a});let a=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(e)),o=e=>{let t=Number(e.replace(/\D/g,""))/100;return new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},l=e=>Number(e.replace(/\D/g,""))/100,n=e=>{try{if(!e)return"Data inv\xe1lida";return new Intl.DateTimeFormat("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}catch(e){return"Data inv\xe1lida"}},c=e=>{if(!e)return"gray";let t=new Date,r=new Date(e);return(t.setHours(0,0,0,0),r.setHours(0,0,0,0),r<t)?"red":r.getTime()===t.getTime()?"orange":3>=Math.ceil((r.getTime()-t.getTime())/864e5)?"yellow":"green"}},99145:(e,t,r)=>{r.d(t,{C1:()=>l.default,CE:()=>x.default,D3:()=>b.default,Es:()=>R.default,Fn:()=>o.default,IJ:()=>i.default,Jc:()=>A.default,Mt:()=>k.default,R2:()=>h.default,Tb:()=>P.default,Td:()=>j.default,XA:()=>p.default,XF:()=>B.default,YJ:()=>N.default,Ze:()=>E.default,_0:()=>n.default,ag:()=>s.default,b1:()=>S.default,b4:()=>f.default,bM:()=>w.default,c1:()=>a.default,cr:()=>m.default,db:()=>D.default,e$:()=>v.default,fl:()=>d.default,j1:()=>T.default,jf:()=>O.default,mo:()=>c.default,nF:()=>u.default,pC:()=>g.default,qU:()=>F.default,r4:()=>C.default,rM:()=>I.default,sy:()=>M.default,u6:()=>y.default,wF:()=>_.default});var a=r(60792);r(59814);var o=r(51065),l=r(36689),n=r(62376),c=r(94456),i=r(48403);r(20969),r(98827),r(27468),r(56872),r(43224),r(53680);var s=r(87928);r(47642),r(25144);var d=r(31052),u=r(66923),g=r(36462);r(19526);var m=r(95035),f=r(98304);r(99437),r(52778);var h=r(33507),x=r(28243);r(83311);var b=r(84582),k=r(8193);r(99597);var p=r(32513),y=r(304);r(86242);var v=r(57299),w=r(93873),D=r(25766),S=r(49163),j=r(1467),N=r(3801),I=r(89856);r(75021),r(76572),r(20578),r(45357),r(92283),r(61807),r(36970),r(2001);var C=r(22950),A=r(63951);r(57786),r(83777);var B=r(61123),F=r(99840),T=r(15949),E=r(72959),O=r(38491),_=r(60444),M=r(64886),R=r(16222),P=r(13671)}}]);