module.exports=[73912,a=>a.a(async(b,c)=>{try{var d=a.i(87924),e=a.i(72131),f=a.i(6704),g=a.i(39323),h=a.i(39906),i=a.i(96438),j=a.i(622),k=a.i(33031),l=a.i(36699),m=a.i(52647),n=b([k,l]);[k,l]=n.then?(await n)():n,a.s(["default",0,({item:a,cotacaoId:b,onSubmit:c,onCancel:n})=>{let[o,p]=(0,e.useState)({fornecedorId:a?.fornecedorId||0,produtoId:a?.produtoId||0,cotacaoId:b,valorUnitario:a?.valorUnitario||"0",quantidade:a?.quantidade||1,aprovada:a?.aprovada||!1,vencedora:a?.vencedora||!1}),[q,r]=(0,e.useState)([]),[s,t]=(0,e.useState)([]),[u,v]=(0,e.useState)(!0),[w,x]=(0,e.useState)({}),[y,z]=(0,e.useState)(!1),[A,B]=(0,e.useState)(a?.valorUnitario?(0,m.formatCurrency)(Number(a.valorUnitario)).replace("R$","").trim():"");(0,e.useEffect)(()=>{C(),D()},[]);let C=async()=>{try{v(!0);let a=await k.produtoService.list({page:1,limit:100});r(a.data)}catch(a){f.toast.error("Erro ao carregar produtos")}finally{v(!1)}},D=async()=>{try{v(!0);let a=await l.fornecedorService.list({page:1,perPage:100});t(a.data)}catch(a){f.toast.error("Erro ao carregar fornecedores")}finally{v(!1)}},E=async a=>{let b;if(a.preventDefault(),b={},["fornecedorId","produtoId","valorUnitario","quantidade"].forEach(a=>{o[a]||(b[a]=`${a.charAt(0).toUpperCase()+a.slice(1)} \xe9 obrigat\xf3rio`)}),o.quantidade<1&&(b.quantidade="Quantidade deve ser maior que zero"),0>=Number(o.valorUnitario)&&(b.valorUnitario="Valor unitário deve ser maior que zero"),x(b),0===Object.keys(b).length){z(!0);try{await c(o)}catch(a){f.toast.error("Erro ao salvar item da cotação")}finally{z(!1)}}};return(0,d.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)(h.default,{htmlFor:"produtoId",children:["Produto",(0,d.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,d.jsx)(j.default,{id:"produtoId",name:"produtoId",value:q.filter(a=>a.id===o.produtoId).map(a=>({value:a.id.toString(),label:`${a.nome} (${a.sku})`}))[0],options:q.map(a=>({value:a.id.toString(),label:`${a.nome} (${a.sku})`})),onChange:a=>{a&&p({...o,produtoId:Number(a.value)})},isSearchable:!0,placeholder:"Selecione um produto",error:w.produtoId})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(h.default,{htmlFor:"fornecedorId",children:["Fornecedor",(0,d.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,d.jsx)(j.default,{id:"fornecedorId",name:"fornecedorId",value:s.filter(a=>a.id===o.fornecedorId).map(a=>({value:a.id.toString(),label:a.nome}))[0],options:s.map(a=>({value:a.id.toString(),label:a.nome})),onChange:a=>{a&&p({...o,fornecedorId:Number(a.value)})},isSearchable:!0,placeholder:"Selecione um fornecedor",error:w.fornecedorId})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(h.default,{htmlFor:"valorUnitario",children:["Valor Unitário",(0,d.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,d.jsx)(g.default,{id:"valorUnitario",name:"valorUnitario",value:A,onChange:a=>{let b=a.target.value.replace(/\D/g,""),c=parseInt(b)/100;B((0,m.formatCurrency)(c).replace("R$","").trim()),p({...o,valorUnitario:c.toFixed(2)})},error:w.valorUnitario,className:"pl-8"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(h.default,{htmlFor:"quantidade",children:["Quantidade",(0,d.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,d.jsx)(g.default,{id:"quantidade",name:"quantidade",type:"number",min:"1",value:o.quantidade,onChange:a=>p({...o,quantidade:Number(a.target.value)}),error:w.quantidade})]}),(0,d.jsxs)("div",{className:"col-span-2 flex gap-4",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("input",{title:"Item Aprovado",type:"checkbox",id:"aprovada",checked:o.aprovada,onChange:a=>p({...o,aprovada:a.target.checked}),className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500"}),(0,d.jsx)(h.default,{htmlFor:"aprovada",className:"ml-2 mb-0",children:"Item Aprovado"})]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("input",{title:"Proposta Vencedora",type:"checkbox",id:"vencedora",checked:o.vencedora,onChange:a=>p({...o,vencedora:a.target.checked}),className:"w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500"}),(0,d.jsx)(h.default,{htmlFor:"vencedora",className:"ml-2 mb-0",children:"Proposta Vencedora"})]})]})]}),(0,d.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,d.jsx)(i.default,{variant:"secondary",onClick:n,type:"button",children:"Cancelar"}),(0,d.jsx)(i.default,{variant:"primary",type:"submit",loading:y,children:a?"Atualizar":"Adicionar"})]})]})}]),c()}catch(a){c(a)}},!1),62477,a=>{"use strict";var b=a.i(69531);a.s(["ChampioIcon",()=>b.default])},80144,a=>a.a(async(b,c)=>{try{var d=a.i(87924),e=a.i(72131),f=a.i(6704),g=a.i(69953),h=a.i(331),i=a.i(16777),j=a.i(73912),k=a.i(96438),l=a.i(52647),m=a.i(8922),n=a.i(622),o=a.i(39906),p=a.i(23091);a.i(54828);var q=a.i(62477),r=a.i(14071),s=a.i(42043),t=a.i(39323),u=b([g,h,j]);function v({params:a}){let{id:b}=(0,e.use)(a),[c,u]=(0,e.useState)(null),[v,w]=(0,e.useState)([]),[x,y]=(0,e.useState)(!0),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(null),[D,E]=(0,e.useState)([]),[F,G]=(0,e.useState)([]),[H,I]=(0,e.useState)(1),[J,K]=(0,e.useState)(1),[L,M]=(0,e.useState)({}),[N,O]=(0,e.useState)(9),P=(0,e.useCallback)(async()=>{try{y(!0);let a=await g.cotacaoService.getById(Number(b));u(a.data)}catch(a){f.toast.error("Erro ao carregar cotação")}},[b]),Q=(0,e.useCallback)(async()=>{try{y(!0);let a=await h.itemCotacaoService.list({cotacaoId:Number(b),page:H,limit:N,aprovados:L.aprovados,vencedores:L.vencedores,produtoIds:L.produtoIds,fornecedorIds:L.fornecedorIds,orderBy:L.orderBy});w(a.data),K(a.pagination.pages)}catch(a){f.toast.error("Erro ao carregar itens")}finally{y(!1)}},[H,L,N,b]);(0,e.useEffect)(()=>{let a=c?.itens||[];E(Array.from(new Map(a.filter(a=>a.produto).map(a=>[a.produto.id,a.produto])).values())),G(Array.from(new Map(a.filter(a=>a.fornecedor).map(a=>[a.fornecedor.id,a.fornecedor])).values())),console.log("itens:",a)},[c]),(0,e.useEffect)(()=>{P(),Q()},[P,Q]),(0,e.useEffect)(()=>{Q()},[Q]);let R=async a=>{try{B?(await h.itemCotacaoService.update(B.id,a),f.toast.success("Item atualizado com sucesso")):(await h.itemCotacaoService.create({...a,cotacaoId:Number(b)}),f.toast.success("Item adicionado com sucesso")),A(!1),C(null),P(),Q()}catch(a){f.toast.error("Erro ao salvar item")}},S=async a=>{if(window.confirm("Tem certeza que deseja excluir este item?"))try{await h.itemCotacaoService.delete(a),f.toast.success("Item excluído com sucesso"),P(),Q()}catch(a){f.toast.error("Erro ao excluir item")}},T=async a=>{try{await h.itemCotacaoService.update(a.id,{...a,aprovada:!a.aprovada}),f.toast.success(`Item ${!a.aprovada?"aprovado":"desaprovado"} com sucesso`),Q()}catch(a){console.error("Erro ao atualizar item:",a),f.toast.error("Erro ao atualizar item")}},U=async a=>{try{await h.itemCotacaoService.update(a.id,{...a,vencedora:!a.vencedora}),f.toast.success(`Item ${!a.vencedora?"marcado":"desmarcado"} como vencedor`),Q()}catch(a){f.toast.error("Erro ao atualizar item")}};return c?(0,d.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)(k.default,{variant:"secondary",size:"xs",onClick:()=>{window.history.back()},className:"mb-2 bg-transparent",children:[(0,d.jsx)(s.ChevronLeftIcon,{className:"w-5 h-5"}),"Voltar"]}),(0,d.jsxs)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:["Cotação #",c.id," - ",c.nome]}),(0,d.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Descrição - ",c.descricao]}),(0,d.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Data de Abertura: ",(0,l.formatDate)(c.dataAbertura)," | Data de Fechamento: ",(0,l.formatDate)(c.dataFechamento)]})]}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)(k.default,{variant:"primary",onClick:()=>{C(null),A(!0)},children:"Adicionar Item"})})]}),(0,d.jsxs)("div",{className:"mt-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(o.default,{children:"Status"}),(0,d.jsx)(n.default,{isMulti:!0,options:[{value:"aprovados",label:"Aprovados"},{value:"vencedores",label:"Vencedores"}],onChange:a=>{M(b=>({...b,aprovados:a?.some(a=>"aprovados"===a.value),vencedores:a?.some(a=>"vencedores"===a.value)}))},placeholder:"Filtrar por status"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(o.default,{children:"Ordenar por"}),(0,d.jsx)(n.default,{options:[{value:"preco_asc",label:"Menor Preço"},{value:"preco_desc",label:"Maior Preço"},{value:"quantidade_asc",label:"Menor Quantidade"},{value:"quantidade_desc",label:"Maior Quantidade"}],onChange:a=>{let b=a?.value;M(a=>({...a,orderBy:b}))},placeholder:"Ordenar por",isClearable:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(o.default,{children:"Produtos"}),(0,d.jsx)(n.default,{isMulti:!0,options:D.map(a=>({value:String(a?.id),label:`${a?.nome} (${a?.sku})`})),onChange:a=>{let b=a?.map(a=>Number(a.value))||[];M(a=>({...a,produtoIds:b}))},placeholder:"Filtrar por produto"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(o.default,{children:"Fornecedores"}),(0,d.jsx)(n.default,{isMulti:!0,options:F.map(a=>({value:String(a?.id),label:a?.nome})),onChange:a=>{let b=a?.map(a=>Number(a.value))||[];M(a=>({...a,fornecedorIds:b}))},placeholder:"Filtrar por fornecedor"})]})]}),(0,d.jsxs)("div",{className:"flex justify-between mb-4 gap-2 flex-wrap",children:[(0,d.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,d.jsx)(o.default,{className:"flex items-center mb-0 h-full",children:"Quantidade por pagina"}),(0,d.jsx)(t.default,{className:"max-w-24",defaultValue:N,max:v.length,min:1,onChange:a=>O(0|Number(a.target.value))})]}),(0,d.jsx)(p.default,{currentPage:H,totalPages:J,onPageChange:I})]})]})]}),x?(0,d.jsx)("div",{className:"grid gap-4",children:[1,2,3].map(a=>(0,d.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-24"},a))}):(0,d.jsx)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:v.length>0?v.map(a=>(0,d.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md shadow-gray-200 dark:shadow-gray-700 border border-gray-200 dark:border-gray-700 p-4",children:(0,d.jsxs)("div",{className:"flex justify-between items-start flex-wrap",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{className:"font-medium text-gray-900 dark:text-white",children:[a.produto?.nome," (",a.produto?.sku,")"]}),(0,d.jsxs)("p",{className:"text-sm text-gray-500",children:["Fornecedor: ",a.fornecedor?.nome]}),(0,d.jsxs)("p",{className:"text-sm text-gray-500",children:["Valor Unitário: ",(0,l.formatCurrency)(Number(a.valorUnitario))," | Quantidade: ",a.quantidade]})]}),(0,d.jsxs)("div",{className:"flex gap-1 flex-wrap",children:[(0,d.jsx)(k.default,{variant:a.aprovada?"success":"secondary",size:"xs",onClick:()=>T(a),title:a.aprovada?"Desaprovar Item":"Aprovar Item",children:(0,d.jsx)(r.CheckLineIcon,{className:"w-4 h-4 overflow-hidden"})}),(0,d.jsx)(k.default,{variant:a.vencedora?"success":"secondary",size:"xs",onClick:()=>U(a),title:a.vencedora?"Desmarcar Vencedor":"Marcar Vencedor",children:(0,d.jsx)(q.ChampioIcon,{className:"w-4 h-4 overflow-hidden"})}),(0,d.jsx)(m.default,{variant:"secondary",size:"xs",onClick:()=>{C(a),A(!0)},title:"Editar Item",icon:"edit"}),(0,d.jsx)(m.default,{title:"Excluir Item",icon:"delete",variant:"secondary",size:"xs",onClick:()=>S(a.id)})]})]})},a.id)):(0,d.jsx)("div",{className:"text-center py-12",children:(0,d.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum item encontrado nesta cotação."})})}),(0,d.jsx)(i.Modal,{isOpen:z,onClose:()=>{A(!1),C(null)},className:"max-w-[800px] m-4",children:(0,d.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,d.jsxs)("div",{className:"px-2 pr-14",children:[(0,d.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:B?"Editar Item":"Novo Item"}),(0,d.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:B?"Atualize as informações do item.":"Preencha os dados para criar um novo item."})]}),(0,d.jsx)(j.default,{item:B||void 0,cotacaoId:Number(b),onSubmit:R,onCancel:()=>{A(!1),C(null)}})]})})]}):null}[g,h,j]=u.then?(await u)():u,a.s(["default",()=>v]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=src_42457538._.js.map