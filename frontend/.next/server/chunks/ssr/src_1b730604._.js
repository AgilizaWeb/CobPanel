module.exports=[50254,a=>{"use strict";var b=a.i(87924);a.i(54828);var c=a.i(84312),d=a.i(44091),e=a.i(53054),f=a.i(96438);let g={A_VENCER:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",NO_DIA:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",VENCIDA:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",COMPROVANTE:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",MANUAL:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300",FINALIZACAO:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"},h={A_VENCER:"A Vencer",NO_DIA:"No Dia",VENCIDA:"Vencida",COMPROVANTE:"Comprovante",MANUAL:"Manual",FINALIZACAO:"Finalização"};a.s(["default",0,({message:a,onEdit:i,onDelete:j})=>(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow shadow-gray-200 dark:shadow-gray-700 border border-gray-200 dark:border-gray-700 p-5",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-full p-2",children:(0,b.jsx)(e.EnvelopeIcon,{className:"text-gray-500 dark:text-gray-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:`px-2.5 py-0.5 text-xs font-medium rounded-full ${g[a.tipo]}`,children:h[a.tipo]}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[a.status?"Ativo":"Inativo"," • Horário: ",a.hora,a.dias>0&&` • ${a.dias} dia(s)`]})]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(f.default,{variant:"secondary",size:"xs",onClick:i,className:"flex items-center justify-center text-gray-400 hover:text-brand-500 dark:hover:text-brand-400 transition-colors",title:"Editar Mensagem",children:(0,b.jsx)(c.EditIcon,{className:"w-5 h-5"})}),(0,b.jsx)(f.default,{variant:"secondary",size:"xs",onClick:j,className:"flex items-center justify-center text-red-500 dark:text-red-400 rounded-md transition-colors",title:"Excluir Mensagem",children:(0,b.jsx)(d.TrashBinIcon,{className:"w-5 h-5"})})]})]}),(0,b.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:(0,b.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 whitespace-pre-wrap",children:[a.mensagem.slice(0,150).split(/(\[[^\]]+\])/).map((a,c)=>a.match(/^\[[^\]]+\]$/)?(0,b.jsx)("span",{className:"px-1 bg-brand-100 text-brand-600 rounded dark:bg-brand-900/20 dark:text-brand-400",children:a},c):a),a.mensagem.length>150&&(0,b.jsx)("span",{className:"text-green-400 bold animate-pulse",children:"..."})]})})]})])},34454,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(39323),e=a.i(39906),f=a.i(96438);a.i(54828);var g=a.i(24913),g=g,h=a.i(5658),i=a.i(52807),i=i,j=a.i(6704),k=a.i(622);let l=[{value:"A_VENCER",label:"A Vencer"},{value:"NO_DIA",label:"No Dia"},{value:"VENCIDA",label:"Vencida"},{value:"COMPROVANTE",label:"Comprovante"},{value:"MANUAL",label:"Manual"},{value:"FINALIZACAO",label:"Finalização"}],m=[{key:"[nomeCliente]",desc:"Nome do cliente"},{key:"[valorCobranca]",desc:"Valor da cobrança"},{key:"[dataVencimento]",desc:"Data de vencimento"},{key:"[linkPagamento]",desc:"Link de pagamento"},{key:"[nomeEmpresa]",desc:"Nome da empresa"},{key:"[cnpjEmpresa]",desc:"CNPJ da empresa"},{key:"[telefoneEmpresa]",desc:"Telefone da empresa"},{key:"[emailEmpresa]",desc:"Email da empresa"}];a.s(["default",0,({message:a,onSubmit:n,onCancel:o})=>{let[p,q]=(0,c.useState)(window.innerWidth>=1024),[r,s]=(0,c.useState)(null),t=(0,c.useRef)(null),u=(0,c.useRef)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({mensagem:a?.mensagem||"",tipo:a?.tipo||"MANUAL",status:a?.status??!0,hora:a?.hora||"09:00",dias:a?.dias??0}),[z,A]=(0,c.useState)({}),[B,C]=(0,c.useState)(!1),D=async a=>{let b;if(a.preventDefault(),b={},x.mensagem?x.mensagem.length<10&&(b.mensagem="Mensagem deve ter no mínimo 10 caracteres"):b.mensagem="Mensagem é obrigatória",x.tipo||(b.tipo="Tipo é obrigatório"),E&&!x.dias&&0!==x.dias&&(b.dias="Dias é obrigatório"),F&&!x.hora&&(b.hora="Horário é obrigatório"),A(b),0===Object.keys(b).length){C(!0);try{await n(x)}catch(a){j.toast.error("Erro ao salvar mensagem")}finally{C(!1)}}},E="A_VENCER"===x.tipo||"VENCIDA"===x.tipo,F=!["FINALIZACAO","COMPROVANTE","MANUAL"].includes(x.tipo);c.default.useEffect(()=>{let a=a=>{u.current&&!u.current.contains(a.target)&&s(null)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let G=async a=>{try{await navigator.clipboard.writeText(a),j.toast.success((0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Variável copiada com sucesso!"}),(0,b.jsx)("p",{className:"text-sm text-gray-300",children:"Use Ctrl+V para colar no campo de mensagem"})]}))}catch(a){j.toast.error((0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Não foi possível copiar a variável"}),(0,b.jsx)("p",{className:"text-sm text-gray-300",children:"Tente selecionar e copiar manualmente"})]}))}};return(0,b.jsxs)("form",{onSubmit:D,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsxs)(e.default,{htmlFor:"tipo",children:["Tipo de Mensagem",(0,b.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,b.jsx)(k.default,{id:"fornecedorId",name:"fornecedorId",value:l.filter(a=>a.value===x.tipo),options:l,onChange:a=>{a&&y({...x,tipo:a.value})},placeholder:"Selecione o fornecedor",error:z.tipo,className:"w-full"})]}),F&&(0,b.jsxs)("div",{children:[(0,b.jsxs)(e.default,{htmlFor:"hora",children:["Horário de Envio",(0,b.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,b.jsx)(d.default,{id:"hora",type:"time",name:"hora",value:x.hora||"",onChange:a=>y({...x,hora:a.target.value}),error:z.hora})]}),E&&(0,b.jsxs)("div",{children:[(0,b.jsxs)(e.default,{htmlFor:"dias",children:["Dias ","A_VENCER"===x.tipo?"Antes":"Após",(0,b.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,b.jsx)(d.default,{id:"dias",type:"number",name:"dias",min:"0",value:x.dias?.toString()||"",onChange:a=>y({...x,dias:parseInt(a.target.value)||0}),error:z.dias})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsxs)(e.default,{htmlFor:"mensagem",children:["Mensagem",(0,b.jsx)("span",{className:"text-error-500",children:"*"})]}),(0,b.jsx)("textarea",{ref:t,id:"mensagem",name:"mensagem",value:x.mensagem,onChange:a=>y({...x,mensagem:a.target.value}),onBlur:()=>{t.current&&w({start:t.current.selectionStart,end:t.current.selectionEnd})},onFocus:()=>{t.current&&v&&t.current.setSelectionRange(v.start,v.end)},rows:5,className:"w-full rounded-lg border border-stroke bg-transparent px-4 py-3 outline-none focus:border-primary focus-visible:shadow-none dark:border-gray-600 dark:bg-gray-900 dark:focus:border-primary dark:text-white",placeholder:"Digite sua mensagem aqui..."}),z.mensagem&&(0,b.jsx)("span",{className:"text-sm text-error-500",children:z.mensagem})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3 cursor-pointer",onClick:()=>q(!p),children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.default,{className:"text-gray-400"}),(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Variáveis Disponíveis"})]}),(0,b.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-600",children:p?(0,b.jsx)(i.default,{}):(0,b.jsx)(h.ChevronDownIcon,{})})]}),p&&(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:m.map(a=>(0,b.jsxs)("div",{onClick:b=>{s({key:a.key,x:b.clientX,y:b.clientY})},className:"text-xs bg-white dark:bg-gray-900 p-2 rounded border border-gray-200 dark:border-gray-700 cursor-pointer hover:border-brand-500 transition-colors",children:[(0,b.jsx)("code",{className:"font-mono text-brand-500 dark:text-brand-400",children:a.key}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:a.desc})]},a.key))})]}),r&&(0,b.jsx)("div",{ref:u,style:{position:"fixed",left:r.x+"px",top:r.y+"px",transform:"translate(-50%, 10px)",zIndex:1e3},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{(a=>{if(t.current&&v){let b=x.mensagem,c=b.substring(0,v.start)+a+b.substring(v.end),d=v.start+a.length;y({...x,mensagem:c}),w({start:d,end:d}),setTimeout(()=>{t.current?.focus(),t.current?.setSelectionRange(d,d)},0)}else{let b=x.mensagem+a;y({...x,mensagem:b});let c=b.length;w({start:c,end:c})}})(r.key),s(null)},className:"w-full px-4 py-2 text-sm text-left text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Inserir"}),(0,b.jsx)("button",{type:"button",onClick:()=>{G(r.key),s(null)},className:"w-full px-4 py-2 text-sm text-left text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Copiar"})]})})]}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"status",name:"status",checked:x.status,onChange:a=>y({...x,status:a.target.checked}),className:"rounded border-gray-300 text-brand-500 focus:ring-brand-500"}),(0,b.jsx)(e.default,{htmlFor:"status",className:"!mb-0",children:"Ativo"})]})})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,b.jsx)(f.default,{variant:"secondary",onClick:o,type:"button",children:"Cancelar"}),(0,b.jsx)(f.default,{variant:"primary",type:"submit",loading:B,children:a?"Atualizar":"Criar"})]})]})}],34454)},96100,a=>a.a(async(b,c)=>{try{var d=a.i(87924),e=a.i(72131),f=a.i(90365),g=a.i(32636),h=a.i(6704),i=a.i(96438),j=a.i(85479),k=a.i(50254),l=a.i(34454),m=a.i(16777),n=b([f,g]);function o(){let{user:a}=(0,g.useAuth)(),[b,c]=(0,e.useState)([]),[n,o]=(0,e.useState)(!0),[p,q]=(0,e.useState)(""),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),[v,w]=(0,e.useState)("ALL"),x=(0,e.useCallback)(async()=>{try{o(!0);let a=await f.services.mensagem.list();c(a.data)}catch(a){h.default.error("Erro ao carregar mensagens")}finally{o(!1)}},[]);(0,e.useEffect)(()=>{x()},[x]);let y=async a=>{if(window.confirm("Tem certeza que deseja excluir esta mensagem?"))try{await f.services.mensagem.delete(a),h.default.success("Mensagem excluída com sucesso"),x()}catch(a){h.default.error("Erro ao excluir mensagem")}},z=async a=>{try{t?(await f.services.mensagem.update(t.id,a),h.default.success("Mensagem atualizada com sucesso")):(await f.services.mensagem.create(a),h.default.success("Mensagem criada com sucesso")),s(!1),u(null),x()}catch(a){h.default.error("Erro ao salvar mensagem")}},A=b.filter(a=>a.mensagem.toLowerCase().includes(p.toLowerCase())&&("ALL"===v||v===a.tipo));return(0,d.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Mensagens"}),(0,d.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie as mensagens automáticas do sistema"})]}),(0,d.jsx)(i.default,{variant:"primary",onClick:()=>{u(null),s(!0)},children:"Nova Mensagem"})]}),(0,d.jsxs)("div",{className:"mt-6",children:[(0,d.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:[{value:"A_VENCER",label:"A Vencer"},{value:"NO_DIA",label:"No Dia"},{value:"VENCIDA",label:"Vencida"},{value:"COMPROVANTE",label:"Comprovante"},{value:"MANUAL",label:"Manual"},{value:"FINALIZACAO",label:"Finalização"},{value:"ALL",label:"Todas"}].map(a=>(0,d.jsx)("button",{onClick:()=>w(a.value),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors
                  ${v===a.value?"bg-brand-500 text-white dark:bg-brand-400 dark:text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:a.label},a.value))}),(0,d.jsx)("div",{className:"w-full md:w-96 mb-6",children:(0,d.jsx)(j.default,{value:p,onChange:a=>q(a.target.value),placeholder:"Buscar mensagens..."})})]})]}),n?(0,d.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(a=>(0,d.jsx)("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded-lg h-48"},a))}):(0,d.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:A.length>0?A.map(a=>(0,d.jsx)(k.default,{message:a,onEdit:()=>{u(a),s(!0)},onDelete:()=>y(a.id)},a.id)):(0,d.jsx)("div",{className:"col-span-full text-center py-12",children:(0,d.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma mensagem encontrada para este tipo."})})}),(0,d.jsx)(m.Modal,{isOpen:r,onClose:()=>{s(!1),u(null)},className:"max-w-[800px] m-4",children:(0,d.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,d.jsxs)("div",{className:"px-2 pr-14",children:[(0,d.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:t?"Editar Mensagem":"Nova Mensagem"}),(0,d.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:t?"Atualize as informações do mensagem.":"Preencha os dados para criar uma nova mensagem."})]}),(0,d.jsx)(l.default,{message:t||void 0,onSubmit:z,onCancel:()=>{s(!1),u(null)}})]})})]})}[f,g]=n.then?(await n)():n,a.s(["default",()=>o]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=src_1b730604._.js.map