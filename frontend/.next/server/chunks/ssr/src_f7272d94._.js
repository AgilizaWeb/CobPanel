module.exports=[89102,a=>{"use strict";var b=a.i(87924),c=a.i(8922);a.s(["default",0,({conexao:a,onEdit:d,onDelete:e,onQrCode:f,onRestart:g,onStop:h})=>(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md shadow-gray-200 dark:shadow-gray-700 border border-gray-200 dark:border-gray-700 p-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.nome}),a.isDefault&&(0,b.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200",children:"Padrão"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.numero}),(0,b.jsxs)("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${(()=>{switch(a?.instance?.state){case"open":return"bg-green-100 text-green-800 border-green-200";case"connecting":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-red-100 text-red-800 border-red-200"}})()}`,children:["Status: ",(()=>{switch(console.log("conexao:",a),a?.instance?.state){case"open":return"Conectado";case"connecting":return"Conectando...";default:return"Desconectado"}})()]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a?.instance?.state==="connecting"&&f&&(0,b.jsx)(c.default,{size:"xs",variant:"success",onClick:f,title:"Escanear QR Code",icon:"qrcode"}),(a?.instance?.state==="open"||a?.instance?.state==="connecting")&&(0,b.jsx)(b.Fragment,{children:h&&(0,b.jsx)(c.default,{size:"xs",variant:"secondary",onClick:h,title:"Parar Conexão",icon:"stop"})}),(a?.instance?.state==="open"||a?.instance?.state==="close")&&(0,b.jsx)(b.Fragment,{children:g&&(0,b.jsx)(c.default,{size:"xs",variant:"secondary",onClick:g,title:"Reiniciar Conexão",icon:"reload"})}),(0,b.jsx)(c.default,{size:"xs",variant:"secondary",onClick:d,title:"Editar Conexão",icon:"edit"}),(0,b.jsx)(c.default,{size:"xs",variant:"secondary",onClick:e,title:"Excluir Conexão",icon:"delete"})]})]})})])},99809,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(39323),e=a.i(96438);function f({conexao:a,onSave:f,onCancel:g}){let[h,i]=(0,c.useState)({nome:a?.nome||"",numero:a?.numero||"",isDefault:a?.isDefault||!1}),[j,k]=(0,c.useState)({}),[l,m]=(0,c.useState)(!1),n=async a=>{let b;if(a.preventDefault(),b={},["nome"].forEach(a=>{h[a]||(b[a]=`${a.charAt(0).toUpperCase()+a.slice(1)} \xe9 obrigat\xf3rio`)}),h.numero&&h.numero.length<10&&(b.numero="Número deve ter pelo menos 10 caracteres"),k(b),0===Object.keys(b).length){m(!0);try{await f(h)}catch(a){(a.response?.data?.details||[]).forEach(a=>{let b=a.field.replace("body.","");k(c=>({...c,[b]:a.message}))})}finally{m(!1)}}};return(0,b.jsxs)("form",{onSubmit:n,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(d.default,{id:"nome",name:"nome",hint:"Nome da Conexão",value:h.nome,onChange:a=>i({...h,nome:a.target.value}),error:j.nome,placeholder:"Ex: WhatsApp Principal"})}),(0,b.jsx)("div",{className:"md:col-span-2",children:(0,b.jsx)(d.default,{id:"numero",name:"numero",hint:"Número",value:h.numero,onChange:a=>i({...h,numero:a.target.value}),error:j.numero,placeholder:"Ex: 5511999999999"})}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{id:"isDefault",name:"isDefault",type:"checkbox",checked:h.isDefault,onChange:a=>i({...h,isDefault:a.target.checked}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded dark:border-gray-600 dark:bg-gray-700"}),(0,b.jsx)("label",{htmlFor:"isDefault",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Conexão padrão"})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Se marcado, esta será a conexão padrão para novas vendas sem conexão específica ou com conexão específica não conectada"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,b.jsx)(e.default,{type:"button",variant:"secondary",onClick:g,children:"Cancelar"}),(0,b.jsx)(e.default,{type:"submit",variant:"primary",disabled:l,children:l?"Salvando...":a?"Atualizar":"Criar"})]})]})}a.s(["default",()=>f])},453,a=>a.a(async(b,c)=>{try{var d=a.i(87924),e=a.i(72131),f=a.i(16777),g=a.i(96438),h=a.i(90365),i=a.i(6704),j=a.i(71987),k=b([h]);[h]=k.then?(await k)():k,a.s(["default",0,({isOpen:a,onClose:b,conexao:c,onStatusUpdate:k})=>{let[l,m]=(0,e.useState)(c),[n,o]=(0,e.useState)(!1),p=(0,e.useRef)(null),[q,r]=(0,e.useState)(25),s=(0,e.useCallback)(async()=>{try{o(!0);let a=await h.services.conexao.getById(c.id);m(a.data),k(a.data),a.data?.instance?.state==="open"&&(i.default.success("Conexão estabelecida com sucesso!"),b())}catch(a){console.error("Erro ao verificar status da conexão:",a),i.default.error("Erro ao verificar status da conexão")}finally{o(!1)}},[c.id,k,b]),t=(0,e.useCallback)(()=>{p.current&&clearInterval(p.current),r(25),p.current=setInterval(()=>{s(),r(25)},25e3);let a=setInterval(()=>{r(a=>a<=1?25:a-1)},1e3);return()=>{clearInterval(a)}},[s]);(0,e.useEffect)(()=>{if(a&&l?.instance?.state==="connecting"){let a=t();return()=>{p.current&&clearInterval(p.current),a()}}return()=>{p.current&&clearInterval(p.current)}},[a,l?.instance?.state,s,t]),(0,e.useEffect)(()=>{m(c)},[c]);let u=()=>{p.current&&clearInterval(p.current),b()};return(0,d.jsx)(f.Modal,{isOpen:a,onClose:u,className:"max-w-[700px] m-4",children:(0,d.jsx)("div",{className:"no-scrollbar relative w-full max-w-[700px] overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-8",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:"Conectar WhatsApp"}),(0,d.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400",children:l.nome}),(0,d.jsx)("div",{className:"mb-6 flex justify-center",children:(0,d.jsx)("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${(()=>{switch(l?.instance?.state){case"connecting":return"bg-blue-100 text-blue-800 border-blue-200";case"open":return"bg-green-100 text-green-800 border-green-200";default:return"bg-red-100 text-red-800 border-red-200"}})()}`,children:(()=>{switch(l?.instance?.state){case"connecting":return"Aguardando conexão...";case"open":return"Conectado";default:return"Desconectado"}})()})}),l?.instance?.state==="connecting"&&(0,d.jsxs)("div",{className:"mb-6",children:[l.instance?.base64?(0,d.jsxs)("div",{className:"p-4 rounded-lg inline-block shadow-sm relative",children:[n&&(0,d.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),(0,d.jsx)(j.default,{src:l.instance.base64,alt:"QR Code",className:"object-contain",width:256,height:256}),(0,d.jsxs)("div",{className:"flex gap-1 w-full justify-center mt-2",children:[(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Codigo de Pareamento:"}),(0,d.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-200",children:l.instance.pairingCode||"N/A"})]})]}):(0,d.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-8 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600 w-72 h-72 flex items-center justify-center",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerando QR Code..."})]})}),(0,d.jsxs)("div",{className:"mt-4 text-center",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:l.instance?.base64?"Escaneie o QR Code com seu WhatsApp":"Aguarde, o QR Code está sendo gerado"}),l.instance?.base64&&(0,d.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,d.jsx)("div",{className:`w-2 h-2 rounded-full ${n?"bg-blue-500 animate-pulse":"bg-green-500"}`}),(0,d.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:n?"Atualizando...":`Pr\xf3xima atualiza\xe7\xe3o em ${q}s`})]})]})]}),l?.instance?.state==="connecting"&&(0,d.jsxs)("div",{className:"mb-6 text-left bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[(0,d.jsx)("h5",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Como conectar:"}),(0,d.jsxs)("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[(0,d.jsx)("li",{children:"1. Abra o WhatsApp no seu celular"}),(0,d.jsx)("li",{children:'2. Toque em "Mais opções" (⋮) → "Aparelhos conectados"'}),(0,d.jsx)("li",{children:'3. Toque em "Conectar um aparelho"'}),(0,d.jsx)("li",{children:"4. Escaneie o QR Code acima"})]})]}),(0,d.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,d.jsx)(g.default,{variant:"secondary",onClick:u,children:"Fechar"}),l?.instance?.state==="connecting"&&(0,d.jsx)(g.default,{variant:"primary",onClick:s,disabled:n,children:n?"Verificando...":"Atualizar"})]})]})})})}]),c()}catch(a){c(a)}},!1),69449,a=>a.a(async(b,c)=>{try{var d=a.i(87924),e=a.i(72131),f=a.i(90365),g=a.i(6704),h=a.i(96438),i=a.i(85479),j=a.i(16777),k=a.i(89102),l=a.i(99809),m=a.i(453),n=b([f,m]);function o(){let[a,b]=(0,e.useState)([]),[c,n]=(0,e.useState)(!0),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(0),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(!1),[y,z]=(0,e.useState)(),A=(0,e.useCallback)(async()=>{try{n(!0);let a=await f.services.conexao.list({page:q,limit:9,...o&&{search:o}});b(a.data),t(Math.ceil(a.pagination.total/9))}catch(a){g.default.error("Erro ao carregar conexões")}finally{n(!1)}},[q,o,9]);(0,e.useEffect)(()=>{A()},[A]);let B=async a=>{if(window.confirm("Tem certeza que deseja reiniciar esta conexão?"))try{await f.services.conexao.restart(a),g.default.success("Conexão reiniciada com sucesso"),A()}catch(a){g.default.error("Erro ao reiniciar conexão")}},C=async a=>{if(window.confirm("Tem certeza que deseja parar esta conexão?"))try{await f.services.conexao.stop(a),g.default.success("Conexão parada com sucesso"),A()}catch(a){g.default.error("Erro ao parar conexão")}},D=async a=>{if(window.confirm("Tem certeza que deseja excluir esta conexão?"))try{await f.services.conexao.delete(a),g.default.success("Conexão excluída com sucesso"),A()}catch(a){g.default.error("Erro ao excluir conexão")}},E=async a=>{try{y?(await f.services.conexao.update(y.id,a),g.default.success("Conexão atualizada com sucesso")):(await f.services.conexao.create(a),g.default.success("Conexão criada com sucesso")),v(!1),z(void 0),A()}catch(a){console.error("Erro ao salvar conexão:",a),g.default.error("Erro ao salvar conexão")}};return(0,d.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Conexões WhatsApp"}),(0,d.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie suas conexões com a Evolution API"})]}),(0,d.jsx)(h.default,{variant:"primary",onClick:()=>{z(void 0),v(!0)},children:"Nova Conexão"})]}),(0,d.jsx)("div",{className:"mt-4 w-full max-w-sm",children:(0,d.jsx)(i.default,{value:o,onChange:a=>p(a.target.value),placeholder:"Buscar conexões..."})})]}),c?(0,d.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(a=>(0,d.jsx)(k.default,{conexao:a,onEdit:()=>{z(a),v(!0)},onDelete:()=>D(a.id),onQrCode:()=>{z(a),x(!0)},onRestart:()=>B(a.id),onStop:()=>C(a.id)},a.id))}),0===a.length&&(0,d.jsx)("div",{className:"text-center py-12",children:(0,d.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma conexão encontrada"})}),s>1&&(0,d.jsx)("div",{className:"mt-6 flex justify-center",children:(0,d.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,d.jsx)(h.default,{variant:"secondary",onClick:()=>r(a=>Math.max(1,a-1)),disabled:1===q,children:"Anterior"}),(0,d.jsxs)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Página ",q," de ",s]}),(0,d.jsx)(h.default,{variant:"secondary",onClick:()=>r(a=>Math.min(s,a+1)),disabled:q===s,children:"Próxima"})]})})]}),(0,d.jsx)(j.Modal,{isOpen:u,onClose:()=>{v(!1),z(void 0)},className:"max-w-[800px] m-4",children:(0,d.jsxs)("div",{className:"no-scrollbar relative w-full overflow-y-auto rounded-3xl bg-white p-4 dark:bg-gray-900 lg:p-11",children:[(0,d.jsxs)("div",{className:"px-2 pr-14",children:[(0,d.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:y?"Editar Conexão":"Nova Conexão"}),(0,d.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:y?"Atualize as informações da conexão.":"Preencha os dados para criar uma nova conexão."})]}),(0,d.jsx)(l.default,{conexao:y,onSave:E,onCancel:()=>{v(!1),z(void 0)}})]})}),y&&(0,d.jsx)(m.default,{isOpen:w,onClose:()=>{x(!1),z(void 0)},conexao:y,onStatusUpdate:a=>{b(b=>b.map(b=>b.id===a.id?a:b))}})]})}[f,m]=n.then?(await n)():n,a.s(["default",()=>o]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=src_f7272d94._.js.map